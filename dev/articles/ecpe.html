<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Examination for the Certificate of Proficiency in English • measr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Open_Sans-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Fira_Code-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Playfair_Display-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Examination for the Certificate of Proficiency in English">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">measr</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.0.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/measr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/paper.html">measr: Bayesian psychometric measurement using Stan</a></li>
    <li><a class="dropdown-item" href="../articles/model-estimation.html">Estimating diagnostic classification models</a></li>
    <li><a class="dropdown-item" href="../articles/model-evaluation.html">Evaluating diagnostic classification models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Case Studies</h6></li>
    <li><a class="dropdown-item" href="../articles/ecpe.html">Examination for the Certificate of Proficiency in English</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.wjakethompson.com/blog/measr/2024-02-measr-1.0.0/">Version 1.0.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.wjakethompson.com/blog/measr/2023-06-measr-0.3.1/">Version 0.3.1</a></li>
    <li><a class="external-link dropdown-item" href="https://www.wjakethompson.com/blog/measr/2023-04-measr-0.2.1/">Version 0.2.1</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/wjakethompson/measr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Examination for the Certificate of Proficiency in English</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/wjakethompson/measr/blob/main/vignettes/articles/ecpe.Rmd" class="external-link"><code>vignettes/articles/ecpe.Rmd</code></a></small>
      <div class="d-none name"><code>ecpe.Rmd</code></div>
    </div>

    
    
<p>The <em>Examination for the Certificate of Proficiency in
English</em> (ECPE) is an assessment that measures advanced English
skills for individuals for whom English is not the primary language. In
this case study, we’ll use data from the grammar section of the ECPE,
which uses 28 items to measure 3 skills: morphosyntactic rules, cohesive
rules, and lexical rules. This data set has previously been used by
<span class="citation">Templin &amp; Hoffman (<a href="#ref-templin-emip-2013">2013</a>)</span> and <span class="citation">X. Liu &amp; Johnson (<a href="#ref-mcmc-handbook">2019</a>)</span> to demonstrate how to
estimate diagnostic classification models (DCMs) with Mplus and Markov
chain Monte Carlo (MCMC), respectively. Additionally, <span class="citation">Templin &amp; Bradshaw (<a href="#ref-hdcm">2014</a>)</span> used this ECPE data as a motivating
example for developing a hierarchical DCM, and <span class="citation">Chen et al. (<a href="#ref-chen2018">2018</a>)</span>
used the ECPE data to evaluate the effectiveness of the
<em>M<sub>2</sub></em> statistic for assessing model fit in the presence
of attribute hierarchies.</p>
<div class="section level2">
<h2 id="explore-the-data">Explore the Data<a class="anchor" aria-label="anchor" href="#explore-the-data"></a>
</h2>
<p>The ECPE data is built into measr and can be accessed by loading the
package. A complete description of the data can be viewed using
<code><a href="https://dcmdata.r-dcm.org/reference/ecpe.html" class="external-link">?ecpe_data</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dcmdata.r-dcm.org" class="external-link">dcmdata</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">ecpe_data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,922 × 29</span></span></span>
<span><span class="co">#&gt;    resp_id    E1    E2    E3    E4    E5    E6    E7    E8    E9   E10</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>       1     1     1     1     0     1     1     1     1     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>       2     1     1     1     1     1     1     1     1     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>       3     1     1     1     1     1     1     0     1     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>       4     1     1     1     1     1     1     1     1     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>       5     1     1     1     1     1     1     1     1     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>       6     1     1     1     1     1     1     1     1     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>       7     1     1     1     1     1     1     1     1     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>       8     0     1     1     1     1     1     0     1     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>       9     1     1     1     1     1     1     1     1     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      10     1     1     1     1     0     0     1     1     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2,912 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 18 more variables: E11 &lt;int&gt;, E12 &lt;int&gt;, E13 &lt;int&gt;, E14 &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   E15 &lt;int&gt;, E16 &lt;int&gt;, E17 &lt;int&gt;, E18 &lt;int&gt;, E19 &lt;int&gt;, E20 &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   E21 &lt;int&gt;, E22 &lt;int&gt;, E23 &lt;int&gt;, E24 &lt;int&gt;, E25 &lt;int&gt;, E26 &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   E27 &lt;int&gt;, E28 &lt;int&gt;</span></span></span></code></pre></div>
<p>We can see that the data set has one row for each respondent, and
that 2,922 respondents completed this section of the ECPE. We also see
that the data has 29 columns. The first column contains respondent
identifiers, and the remaining 28 columns contain dichotomous item
responses for each items. The item responses are coded as 0 for an
incorrect response and 1 for a correct response.</p>
<p>In addition to the data, we also have a Q-matrix that define which
attributes are measured by each item. The Q-matrix has 28 rows, which
corresponds to the total number of items. The first column of the
Q-matrix contains item identifiers, which are the same as the column
names in <code>ecpe_data</code> that contain item responses. The
remaining columns define the attributes measured by the ECPE. A value of
0 indicates that the item does not measure that attribute, whereas a
value of 1 indicates that the attribute is measured by that item. For
example, item E1 measures both morphosyntactic rules and cohesive rules,
and item E4 measures only lexical rules.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ecpe_qmatrix</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 28 × 4</span></span></span>
<span><span class="co">#&gt;    item_id morphosyntactic cohesive lexical</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> E1                    1        1       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> E2                    0        1       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> E3                    1        0       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> E4                    0        0       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> E5                    0        0       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> E6                    0        0       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> E7                    1        0       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> E8                    0        1       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> E9                    0        0       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> E10                   1        0       0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 18 more rows</span></span></span></code></pre></div>
<p>For a quick summary of the data, we can calculate the proportion of
respondents that answered each question correctly (i.e., the item
<em>p</em>-values).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">ecpe_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="op">-</span><span class="va">resp_id</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"item_id"</span>, values_to <span class="op">=</span> <span class="st">"pvalue"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 28 × 2</span></span></span>
<span><span class="co">#&gt;    item_id pvalue</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> E1       0.803</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> E2       0.830</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> E3       0.579</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> E4       0.706</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> E5       0.887</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> E6       0.854</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> E7       0.721</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> E8       0.898</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> E9       0.702</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> E10      0.658</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 18 more rows</span></span></span></code></pre></div>
<p>We can then join the item <em>p</em>-values with the Q-matrix to get
a sense of which attributes are the most difficult. Overall, most of the
items have relatively high <em>p</em>-values, with most items having a
<em>p</em>-value between .6 and .9. Note that in general, items
measuring morphosyntactic rules tend to be the most difficult (i.e.,
lower <em>p</em>-values), followed by items measuring cohesive rules,
and finally items measuring lexical rules.</p>
<details><summary>
Plot code
</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ecpe_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="op">-</span><span class="va">resp_id</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"item_id"</span>, values_to <span class="op">=</span> <span class="st">"pvalue"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">ecpe_qmatrix</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by</a></span><span class="op">(</span><span class="va">item_id</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">morphosyntactic</span>, <span class="va">cohesive</span>, <span class="va">lexical</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"attribute"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"measured"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">measured</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html" class="external-link">str_to_title</a></span><span class="op">(</span><span class="va">attribute</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">"/&lt;br&gt;"</span><span class="op">)</span>,</span>
<span>            .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">item_id</span>, <span class="va">pvalue</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>measures <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html" class="external-link">fct_reorder</a></span><span class="op">(</span><span class="va">measures</span>, <span class="va">pvalue</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pvalue</span>, y <span class="op">=</span> <span class="va">measures</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">measures</span><span class="op">)</span>,</span>
<span>             position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.2</span>, width <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                                        seed <span class="op">=</span> <span class="fl">1213</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">4</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#023047"</span>, <span class="st">"#D7263D"</span>, <span class="st">"#8ECAE6"</span>, <span class="st">"#219EBC"</span>,</span>
<span>                                <span class="st">"#F3D3BD"</span>, <span class="st">"#000000"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Item *p*-value"</span>, y <span class="op">=</span> <span class="st">"Measured attributes"</span><span class="op">)</span></span></code></pre></div>
</details><p><img src="ecpe_files/figure-html/pvalue-plot-1.png" alt="Scatter plot showing item p-values on the x-axis and attribute combinations from the Q-matrix on the y-axis." width="90%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="dcm-estimation">DCM Estimation<a class="anchor" aria-label="anchor" href="#dcm-estimation"></a>
</h2>
<p>Now that we have a feel for our data, we will estimate a DCM.
Following the original analysis of the ECPE data by <span class="citation">Templin &amp; Hoffman (<a href="#ref-templin-emip-2013">2013</a>)</span>, we’ll estimate a
loglinear cognitive diagnostic model (LCDM). The LCDM is a general
diagnostic model that allows for different attribute relationships on
items (e.g., compensatory, non-compensatory) and subsumes many other
types of DCMs <span class="citation">(<a href="#ref-lcdm">Henson et al.,
2009</a>; <a href="#ref-lcdm-handbook">Henson &amp; Templin,
2019</a>)</span>.</p>
<p>The following code will estimate an LCDM. In the first two lines, we
specify our data, Q-matrix, and the respondent and item identifiers. We
then specify the type of DCM we want to estimate and define how the
model should be estimated. In this case, we want to estimate the model
using MCMC with the <a href="https://mc-stan.org/rstan" class="external-link">rstan</a>
package as the estimation engine. Finally, we can customize how the MCMC
process is executed. For this example, we specified 4 chains, each with
1,000 warmup iterations and 500 retained iterations for 1,500 iterations
total. This results in a total posterior distribution of 2,000 samples
for each parameter (i.e., 500 iterations from each of the 4 chains). We
also specified a file so that the estimated model will be saved once it
is estimated.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://measr.info">measr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'measr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     optim</span></span>
<span></span>
<span><span class="va">ecpe_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dcmstan.r-dcm.org/reference/dcm_specify.html" class="external-link">dcm_specify</a></span><span class="op">(</span>qmatrix <span class="op">=</span> <span class="va">ecpe_qmatrix</span>, identifier <span class="op">=</span> <span class="st">"item_id"</span>,</span>
<span>                         measurement_model <span class="op">=</span> <span class="fu"><a href="https://dcmstan.r-dcm.org/reference/measurement-model.html" class="external-link">lcdm</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         structural_model <span class="op">=</span> <span class="fu"><a href="https://dcmstan.r-dcm.org/reference/structural-model.html" class="external-link">unconstrained</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ecpe_lcdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dcm_estimate.html">dcm_estimate</a></span><span class="op">(</span><span class="va">ecpe_spec</span>, data <span class="op">=</span> <span class="va">ecpe_data</span>, identifier <span class="op">=</span> <span class="st">"resp_id"</span>,</span>
<span>                          method <span class="op">=</span> <span class="st">"mcmc"</span>, backend <span class="op">=</span> <span class="st">"rstan"</span>,</span>
<span>                          chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">1500</span>, warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                          file <span class="op">=</span> <span class="st">"fits/ecpe-lcdm"</span><span class="op">)</span></span></code></pre></div>
<p>Now that we’ve estimated a model, let’s examine the output. There are
three types of information we’ll examine: structural parameters, item
parameters, and respondent proficiency.</p>
<div class="section level3">
<h3 id="structural-parameters">Structural Parameters<a class="anchor" aria-label="anchor" href="#structural-parameters"></a>
</h3>
<p>The structural parameters define the base rate of membership in each
of attribute profiles. Because the ECPE data consists of 3 dichotomous
attributes, there are a total of 2<sup>3</sup> = 8 possible profiles, or
classes. We can view the possible profiles using
<code><a href="../reference/measr_extract.html">measr_extract()</a></code>. This function extracts different aspects
of a model estimated with measr. The order of the attributes in the
profiles corresponds to the order the attributes were listed in the
Q-matrix used to estimate the model. This means that attributes 1, 2,
and 3 correspond to morphosyntactic, cohesive, and lexical rules,
respectively.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ecpe_classes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/measr_extract.html">measr_extract</a></span><span class="op">(</span><span class="va">ecpe_lcdm</span>, <span class="st">"classes"</span><span class="op">)</span></span>
<span><span class="va">ecpe_classes</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 4</span></span></span>
<span><span class="co">#&gt;   class   morphosyntactic cohesive lexical</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> [0,0,0]               0        0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> [1,0,0]               1        0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> [0,1,0]               0        1       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> [0,0,1]               0        0       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> [1,1,0]               1        1       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> [1,0,1]               1        0       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> [0,1,1]               0        1       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> [1,1,1]               1        1       1</span></span></code></pre></div>
<p>We can extract the structural parameters also using
<code><a href="../reference/measr_extract.html">measr_extract()</a></code>. For structural parameters, we see the
<code>class</code>, or the attribute profile, and the estimated
proportion of respondents in that class with a measure of error (the
standard deviation of the posterior). For example, nearly 30% of
respondents are estimated to not be proficient on any of the attributes
(class 1), and 17% are estimated to proficient on just attributes 2 and
3 (class 7).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">structural_parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/measr_extract.html">measr_extract</a></span><span class="op">(</span><span class="va">ecpe_lcdm</span>, <span class="st">"strc_param"</span><span class="op">)</span></span>
<span><span class="va">structural_parameters</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 2</span></span></span>
<span><span class="co">#&gt;   class           estimate</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;rvar[1d]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> [0,0,0]  0.2971 <span style="color: #949494;">± 0.0170</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> [1,0,0]  0.0120 <span style="color: #949494;">± 0.0065</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> [0,1,0]  0.0169 <span style="color: #949494;">± 0.0108</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> [0,0,1]  0.1282 <span style="color: #949494;">± 0.0199</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> [1,1,0]  0.0094 <span style="color: #949494;">± 0.0056</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> [1,0,1]  0.0178 <span style="color: #949494;">± 0.0101</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> [0,1,1]  0.1731 <span style="color: #949494;">± 0.0200</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> [1,1,1]  0.3455 <span style="color: #949494;">± 0.0173</span></span></span></code></pre></div>
<p>When looking at the structural parameters, we can see that
respondents typically fall into only 4 of the 8 possible profiles.
Specifically, respondents are typically proficient on no attributes,
only attribute 3 (lexical rules), only attributes 2 and 3 (cohesive and
lexical rules), or all attributes. This may indicate the presence of an
attribute hierarchy, as suggested by <span class="citation">Templin
&amp; Bradshaw (<a href="#ref-hdcm">2014</a>)</span>, where respondents
must gain proficiency of lexical rules before they can gain proficiency
of cohesive rules, and then finally morphosyntactic rules.</p>
<details><summary>
Plot code
</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">structural_parameters</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>class <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html" class="external-link">fct_inorder</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span>,</span>
<span>         prob <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">estimate</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">class</span>, y <span class="op">=</span> <span class="va">prob</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">msr_colors</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Class"</span>, y <span class="op">=</span> <span class="st">"Base rate"</span><span class="op">)</span></span></code></pre></div>
</details><p><img src="ecpe_files/figure-html/strc-plot-1.png" alt="Bar graph showing the estimated proportion of respondents with each attribute profile." width="90%" style="display: block; margin: auto;"></p>
<p>We can also collapse across classes to calculate the base rate of
proficiency for each individual attribute. Overall, the model estimates
that 38% of respondents are proficient on morphosyntactic rules, 54% of
respondents are proficient on cohesive rules, and 66% of respondents are
proficient on lexical rules.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ecpe_classes</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">structural_parameters</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>morphosyntactic <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/posterior/reference/rvar-summaries-within-draws.html" class="external-link">rvar_sum</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">morphosyntactic</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>            cohesive <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/posterior/reference/rvar-summaries-within-draws.html" class="external-link">rvar_sum</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">cohesive</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>            lexical <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/posterior/reference/rvar-summaries-within-draws.html" class="external-link">rvar_sum</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">lexical</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;   morphosyntactic      cohesive       lexical</span></span>
<span><span class="co">#&gt;        <span style="color: #949494; font-style: italic;">&lt;rvar[1d]&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;rvar[1d]&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;rvar[1d]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    0.38 <span style="color: #949494;">± 0.019</span>  0.54 <span style="color: #949494;">± 0.029</span>  0.66 <span style="color: #949494;">± 0.015</span></span></span></code></pre></div>
<p>In summary, both the profile- and attribute-level base rates tell a
similar story. Respondents are most likely to be proficient on lexical
rules and least likely to be proficient on morphosyntactic rules. This
also mirrors our analysis of item <em>p</em>-values when we were
exploring the data, which showed that items measuring morphosyntactic
rules were more difficult than items measuring lexical or cohesive
rules.</p>
</div>
<div class="section level3">
<h3 id="item-parameters">Item Parameters<a class="anchor" aria-label="anchor" href="#item-parameters"></a>
</h3>
<p>The item parameters define the log-odds of a respondent in each class
providing a correct response. We can again extract our estimated item
parameters using <code><a href="../reference/measr_extract.html">measr_extract()</a></code>. Here, the
<code>estimate</code> column reports estimated value for each parameter
and a measure of the associated error (i.e., the standard deviation of
the posterior distribution). For example, item E1 has four parameters,
as it measures two attributes:</p>
<ol style="list-style-type: decimal">
<li>An intercept, which represents the log-odds of providing a correct
response for a respondent who is proficient in neither of the attributes
this item measures (i.e., morphosyntactic rules and cohesive
rules).</li>
<li>A main effect for morphosyntactic rules, which represents the
increase in the log-odds of providing a correct response for a
respondent who is proficient in that attribute.</li>
<li>A main effect for cohesive rules, which represents the increase in
the log-odds of providing a correct response for a respondent who is
proficient in that attribute.</li>
<li>An interaction between morphosyntactic and cohesive rules, which is
the change in the log-odds for a respondent who is proficient in both
attributes.</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">item_parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/measr_extract.html">measr_extract</a></span><span class="op">(</span><span class="va">ecpe_lcdm</span>, what <span class="op">=</span> <span class="st">"item_param"</span><span class="op">)</span></span>
<span><span class="va">item_parameters</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 74 × 5</span></span></span>
<span><span class="co">#&gt;    item_id type        attributes               coefficient       estimate</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;rvar[1d]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> E1      intercept   <span style="color: #BB0000;">NA</span>                       l1_0          0.81 <span style="color: #949494;">± 0.077</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> E1      maineffect  morphosyntactic          l1_11         0.66 <span style="color: #949494;">± 0.409</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> E1      maineffect  cohesive                 l1_12         0.65 <span style="color: #949494;">± 0.221</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> E1      interaction morphosyntactic__cohesi… l1_212        0.47 <span style="color: #949494;">± 0.528</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> E2      intercept   <span style="color: #BB0000;">NA</span>                       l2_0          1.04 <span style="color: #949494;">± 0.080</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> E2      maineffect  cohesive                 l2_12         1.23 <span style="color: #949494;">± 0.155</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> E3      intercept   <span style="color: #BB0000;">NA</span>                       l3_0         -0.35 <span style="color: #949494;">± 0.075</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> E3      maineffect  morphosyntactic          l3_11         0.74 <span style="color: #949494;">± 0.381</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> E3      maineffect  lexical                  l3_13         0.36 <span style="color: #949494;">± 0.116</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> E3      interaction morphosyntactic__lexical l3_213        0.53 <span style="color: #949494;">± 0.398</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 64 more rows</span></span></span></code></pre></div>
<p>We can compare these estimates to those that <span class="citation">Templin &amp; Hoffman (<a href="#ref-templin-emip-2013">2013</a>)</span> reported when using
different software to estimate the same model. In the following figure,
most parameters fall on or very close to the dashed line, which
represents perfect agreement.</p>
<details><summary>
Plot code
</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">param_compare</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">measr_est</span>, y <span class="op">=</span> <span class="va">mplus_est</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">type</span>, shape <span class="op">=</span> <span class="va">type</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">msr_colors</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"measr"</span>, y <span class="op">=</span> <span class="st">"Templin &amp; Hoffman (2013)"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Parameter Type"</span>, shape <span class="op">=</span> <span class="st">"Parameter Type"</span><span class="op">)</span></span></code></pre></div>
</details><p><img src="ecpe_files/figure-html/lcdm-param-compare-1.png" alt="Figure shows a strong correlation between item parameters, with only a few discrepancies off of the line of perfect agreement." width="90%" style="display: block; margin: auto;"></p>
<p>There are some parameters that deviate from the line of perfect
agreement, but these are expected. For example, take item E7, which
measures morphosyntactic and lexical rules. Both measr and <span class="citation">Templin &amp; Hoffman (<a href="#ref-templin-emip-2013">2013</a>)</span> report values of
approximately -0.09 for the intercept and 0.93 for the main effect of
lexical rules. For the main effect of morphosyntactic rules, measr
estimated a value of 1.57, compared to a value of 2.86 reported by <span class="citation">Templin &amp; Hoffman (<a href="#ref-templin-emip-2013">2013</a>)</span>, a difference of -1.29.
Similarly, the interaction term estimated by measr is 0.39, compared to
a value of -0.95 reported by <span class="citation">Templin &amp;
Hoffman (<a href="#ref-templin-emip-2013">2013</a>)</span>, a difference
of 1.34. This indicates that the log-odds of providing a correct
response for an individual who has mastered both attributes is
approximately the same, regardless of software. That is, for measr, we
get a log-odds of <code>-0.07 + 1.57 + 0.91 + 0.39 = 2.79</code>, and
from <span class="citation">Templin &amp; Hoffman (<a href="#ref-templin-emip-2013">2013</a>)</span>, we get a log-odds of
<code>-0.11 + 2.86 + 0.95 + -0.95 = 2.75</code>. This is true for all of
the differences in the figure. There is a change to the main effect for
morphosyntactic rules and corresponding change to the interaction term
that “cancels out” the difference.</p>
<p>Why is this happening? Let’s revisit the proportion of respondents in
each class. There are very few respondents who are proficient in
morphosyntactic rules without also being proficient in both of the other
attributes (classes 2, 5, and 6; less than 4% of all respondents).
Therefore, there is less information for estimating the morphosyntactic
main effects, which for items that measure multiple attributes,
represent the increase in log-odds for proficiency in morphosyntactic
rules <em>conditional on not being proficient</em> on the other
attribute.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">structural_parameters</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 2</span></span></span>
<span><span class="co">#&gt;   class           estimate</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;rvar[1d]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> [0,0,0]  0.2971 <span style="color: #949494;">± 0.0170</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> [1,0,0]  0.0120 <span style="color: #949494;">± 0.0065</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> [0,1,0]  0.0169 <span style="color: #949494;">± 0.0108</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> [0,0,1]  0.1282 <span style="color: #949494;">± 0.0199</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> [1,1,0]  0.0094 <span style="color: #949494;">± 0.0056</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> [1,0,1]  0.0178 <span style="color: #949494;">± 0.0101</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> [0,1,1]  0.1731 <span style="color: #949494;">± 0.0200</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> [1,1,1]  0.3455 <span style="color: #949494;">± 0.0173</span></span></span></code></pre></div>
<p>Because there is less information available for the morphosyntactic
main effects, the prior will have more influence on these parameters.
Note in the above figure that the main effect estimates that are off the
diagonal are less extreme when using measr. For example, the triangle at
the top right is a main effect that was estimated to be nearly 3 by
<span class="citation">Templin &amp; Hoffman (<a href="#ref-templin-emip-2013">2013</a>)</span>, but is just over 1.5
when the model is estimated with measr. Thus, there is a regularizing
effect, where the prior is pulling in extreme values, which is an
intended outcome. We did not discuss priors when estimating our model
and instead used the default priors provided by measr. For more
information on prior distributions, including information on how to
specify your own prior distributions for the model parameters, see
<code><a href="https://dcmstan.r-dcm.org/reference/prior.html" class="external-link">?prior</a></code> and the <a href="../model-estimation.html">model
estimation vignette</a>.</p>
</div>
<div class="section level3">
<h3 id="respondent-proficiency">Respondent Proficiency<a class="anchor" aria-label="anchor" href="#respondent-proficiency"></a>
</h3>
<p>The final piece of output from our model we will examine is the
respondent probabilities. There are two types of probabilities that we
can calculate, both of which are returned by the <code><a href="../reference/score.html">score()</a></code>
function.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resp_probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="va">ecpe_lcdm</span><span class="op">)</span></span>
<span><span class="va">resp_probs</span></span>
<span><span class="co">#&gt; $class_probabilities</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 23,376 × 5</span></span></span>
<span><span class="co">#&gt;    resp_id class   probability       `2.5%`    `97.5%`</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1       [0,0,0] 0.000<span style="text-decoration: underline;">007</span>66  0.000<span style="text-decoration: underline;">003</span>79   0.000<span style="text-decoration: underline;">013</span>5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1       [1,0,0] 0.000<span style="text-decoration: underline;">099</span>9   0.000<span style="text-decoration: underline;">007</span>23   0.000<span style="text-decoration: underline;">300</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1       [0,1,0] 0.000<span style="text-decoration: underline;">000</span>525 0.000<span style="text-decoration: underline;">000</span>030<span style="text-decoration: underline;">8</span> 0.000<span style="text-decoration: underline;">001</span>46</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1       [0,0,1] 0.001<span style="text-decoration: underline;">31</span>     0.000<span style="text-decoration: underline;">735</span>     0.002<span style="text-decoration: underline;">09</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1       [1,1,0] 0.000<span style="text-decoration: underline;">089</span>5   0.000<span style="text-decoration: underline;">007</span>67   0.000<span style="text-decoration: underline;">271</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1       [1,0,1] 0.042<span style="text-decoration: underline;">4</span>      0.003<span style="text-decoration: underline;">46</span>      0.102     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1       [0,1,1] 0.002<span style="text-decoration: underline;">07</span>     0.001<span style="text-decoration: underline;">29</span>      0.003<span style="text-decoration: underline;">10</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1       [1,1,1] 0.954       0.894        0.993     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2       [0,0,0] 0.000<span style="text-decoration: underline;">005</span>84  0.000<span style="text-decoration: underline;">002</span>77   0.000<span style="text-decoration: underline;">010</span>8 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2       [1,0,0] 0.000<span style="text-decoration: underline;">076</span>3   0.000<span style="text-decoration: underline;">005</span>75   0.000<span style="text-decoration: underline;">243</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 23,366 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $attribute_probabilities</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8,766 × 5</span></span></span>
<span><span class="co">#&gt;    resp_id attribute       probability `2.5%` `97.5%`</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1       morphosyntactic       0.997  0.995   0.998</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1       cohesive              0.956  0.896   0.995</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1       lexical               1.00   1.00    1.00 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2       morphosyntactic       0.995  0.992   0.997</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2       cohesive              0.902  0.776   0.987</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2       lexical               1.00   1.00    1.00 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 3       morphosyntactic       0.983  0.971   0.991</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 3       cohesive              0.988  0.974   0.997</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 3       lexical               1.00   1.00    1.00 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 4       morphosyntactic       0.998  0.996   0.998</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 8,756 more rows</span></span></span></code></pre></div>
<p>The <code>class_probabilites</code> are the probabilities that the
respondent belongs to each of the 8 possible classes (i.e., profiles of
proficiency). The <code>attribute_probabilites</code> are the
probabilities that the respondent is proficient on each of the
individual attributes. To better describe the difference between these
two probabilities, let’s look at the results for respondent 73. When
looking at the class probabilities, the most likely profile is [1,1,1],
meaning that the respondent is proficient on all attributes. However,
there is only a 39% chance that the respondent belongs to that class.
They also have a greater than 10% chance of belonging to the [0,0,1] and
[0,1,1] classes.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resp_probs</span><span class="op">$</span><span class="va">class_probabilities</span> <span class="op">|&gt;</span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">resp_id</span> <span class="op">==</span> <span class="fl">73</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 5</span></span></span>
<span><span class="co">#&gt;   resp_id class   probability   `2.5%` `97.5%`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 73      [0,0,0]     0.049<span style="text-decoration: underline;">3</span>  0.024<span style="text-decoration: underline;">1</span>    0.088<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 73      [1,0,0]     0.005<span style="text-decoration: underline;">91</span> 0.000<span style="text-decoration: underline;">368</span>  0.020<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 73      [0,1,0]     0.004<span style="text-decoration: underline;">58</span> 0.000<span style="text-decoration: underline;">240</span>  0.013<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 73      [0,0,1]     0.170   0.096<span style="text-decoration: underline;">1</span>    0.268 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 73      [1,1,0]     0.007<span style="text-decoration: underline;">64</span> 0.000<span style="text-decoration: underline;">366</span>  0.028<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 73      [1,0,1]     0.013<span style="text-decoration: underline;">1</span>  0.001<span style="text-decoration: underline;">05</span>   0.034<span style="text-decoration: underline;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> 73      [0,1,1]     0.360   0.243     0.476 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> 73      [1,1,1]     0.389   0.247     0.534</span></span></code></pre></div>
<p>The attribute probabilities for respondent 73 show a slightly
different story. These probabilities indicate that there is a 42% chance
the respondent is proficient on morphosyntactic rules, a 76% chance the
respondent is proficient on cohesive rules, and a 93% chance the
respondent is proficient on lexical rules. That is, we’re fairly
confident respondent 73 is proficient lexical rules, somewhat confident
they are proficient on cohesive rules, and not confident about whether
or not the student is proficient on morphosyntactic rules (i.e., the
proficiency probability could reasonably be as low as 27% or as high as
57%). These probabilities can be turned into classifications by setting
proficiency thresholds. For example, we might decide that probabilities
greater than .5 (i.e., more likely than not) indicate proficiency <span class="citation">(e.g., <a href="#ref-bradshaw-2019">Bradshaw &amp;
Levy, 2019</a>)</span>. On the other hand, we might want to be more
confident that a respondent is proficient before reporting as such, and
therefore might set a higher threshold <span class="citation">(e.g., .8,
<a href="#ref-thompson-ame">Thompson et al., 2019</a>)</span>. For
respondent 73, thresholds of .5 and .8 would result in proficiency
profiles of [0,1,1] and [0,0,1], respectively. Either way, both profiles
differ from the overall most likely profile indicated by the class
probabilities. Thus, it is important to give careful consideration to
how results are determined before they are reported.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resp_probs</span><span class="op">$</span><span class="va">attribute_probabilities</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">resp_id</span> <span class="op">==</span> <span class="fl">73</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   resp_id attribute       probability `2.5%` `97.5%`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 73      morphosyntactic       0.416  0.269   0.570</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 73      cohesive              0.761  0.644   0.855</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 73      lexical               0.933  0.881   0.967</span></span></code></pre></div>
<p>By default, <code><a href="../reference/score.html">score()</a></code> only returns a summary of the
posterior distribution for each probability (i.e., the mean and 95%
credible interval). There are many class and attribute probabilities,
and therefore the object containing the full posterior distributions
would be quite large. You can change the percentiles that are returned
in the posterior summary by setting the <code>probs</code> argument to
quantiles other than the default of
<code>probs = c(0.025, 0.975)</code>. Alternatively, if you do want the
full posterior distribution for each probability, you can set
<code>summary = FALSE</code>. This will return a
<code><a href="https://mc-stan.org/posterior/reference/rvar.html" class="external-link">posterior::rvar()</a></code> object (the same as the structural and
item parameter summaries) that contains all of the posterior draws for
each probability, and is displayed as the mean of the posterior ±1
standard deviation. For more information on <code>rvar</code> objects,
see the accompanying vignette
(<code><a href="https://mc-stan.org/posterior/articles/rvar.html" class="external-link">vignette("rvar", package = "posterior")</a></code>).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="va">ecpe_lcdm</span>, summary <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; $class_probabilities</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,922 × 9</span></span></span>
<span><span class="co">#&gt;    resp_id          `[0,0,0]`              `[1,0,0]`          `[0,1,0]`</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;rvar[1d]&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;rvar[1d]&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;rvar[1d]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1        7.7e-06 <span style="color: #949494;">± 2.5e-06</span>  0.0000999 <span style="color: #949494;">± 0.0000798</span>  5.2e-07 <span style="color: #949494;">± 3.8e-07</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2        5.8e-06 <span style="color: #949494;">± 2.0e-06</span>  0.0000763 <span style="color: #949494;">± 0.0000622</span>  2.1e-07 <span style="color: #949494;">± 1.8e-07</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 3        5.6e-06 <span style="color: #949494;">± 2.1e-06</span>  0.0000168 <span style="color: #949494;">± 0.0000172</span>  1.8e-06 <span style="color: #949494;">± 1.3e-06</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 4        3.2e-07 <span style="color: #949494;">± 1.1e-07</span>  0.0000041 <span style="color: #949494;">± 0.0000032</span>  1.0e-07 <span style="color: #949494;">± 7.2e-08</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 5        1.2e-03 <span style="color: #949494;">± 3.7e-04</span>  0.0086487 <span style="color: #949494;">± 0.0063399</span>  3.7e-04 <span style="color: #949494;">± 2.6e-04</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 6        3.0e-06 <span style="color: #949494;">± 1.0e-06</span>  0.0000158 <span style="color: #949494;">± 0.0000148</span>  9.3e-07 <span style="color: #949494;">± 6.7e-07</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 7        3.0e-06 <span style="color: #949494;">± 1.0e-06</span>  0.0000158 <span style="color: #949494;">± 0.0000148</span>  9.3e-07 <span style="color: #949494;">± 6.7e-07</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 8        3.8e-02 <span style="color: #949494;">± 1.2e-02</span>  0.0000862 <span style="color: #949494;">± 0.0001018</span>  1.4e-03 <span style="color: #949494;">± 1.1e-03</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 9        6.5e-05 <span style="color: #949494;">± 1.9e-05</span>  0.0002082 <span style="color: #949494;">± 0.0001485</span>  2.1e-05 <span style="color: #949494;">± 1.4e-05</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10       4.1e-01 <span style="color: #949494;">± 1.4e-01</span>  0.4156164 <span style="color: #949494;">± 0.1798912</span>  3.7e-03 <span style="color: #949494;">± 3.0e-03</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2,912 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5 more variables: `[0,0,1]` &lt;rvar[1d]&gt;, `[1,1,0]` &lt;rvar[1d]&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `[1,0,1]` &lt;rvar[1d]&gt;, `[0,1,1]` &lt;rvar[1d]&gt;, `[1,1,1]` &lt;rvar[1d]&gt;</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $attribute_probabilities</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,922 × 4</span></span></span>
<span><span class="co">#&gt;    resp_id   morphosyntactic       cohesive          lexical</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;rvar[1d]&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;rvar[1d]&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;rvar[1d]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1        0.9966 <span style="color: #949494;">± 0.00067</span>  0.96 <span style="color: #949494;">± 0.0251</span>  1.00 <span style="color: #949494;">± 0.000116</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2        0.9950 <span style="color: #949494;">± 0.00133</span>  0.90 <span style="color: #949494;">± 0.0558</span>  1.00 <span style="color: #949494;">± 0.000074</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 3        0.9827 <span style="color: #949494;">± 0.00522</span>  0.99 <span style="color: #949494;">± 0.0058</span>  1.00 <span style="color: #949494;">± 0.000079</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 4        0.9976 <span style="color: #949494;">± 0.00051</span>  0.99 <span style="color: #949494;">± 0.0057</span>  1.00 <span style="color: #949494;">± 0.000014</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 5        0.9880 <span style="color: #949494;">± 0.00235</span>  0.98 <span style="color: #949494;">± 0.0086</span>  0.95 <span style="color: #949494;">± 0.025971</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 6        0.9924 <span style="color: #949494;">± 0.00211</span>  0.99 <span style="color: #949494;">± 0.0058</span>  1.00 <span style="color: #949494;">± 0.000068</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 7        0.9924 <span style="color: #949494;">± 0.00211</span>  0.99 <span style="color: #949494;">± 0.0058</span>  1.00 <span style="color: #949494;">± 0.000068</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 8        0.0044 <span style="color: #949494;">± 0.00193</span>  0.44 <span style="color: #949494;">± 0.0818</span>  0.96 <span style="color: #949494;">± 0.011942</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 9        0.9452 <span style="color: #949494;">± 0.01210</span>  0.98 <span style="color: #949494;">± 0.0061</span>  1.00 <span style="color: #949494;">± 0.000766</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10       0.5448 <span style="color: #949494;">± 0.15235</span>  0.12 <span style="color: #949494;">± 0.0621</span>  0.11 <span style="color: #949494;">± 0.049288</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2,912 more rows</span></span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="dcm-evaluation">DCM Evaluation<a class="anchor" aria-label="anchor" href="#dcm-evaluation"></a>
</h2>
<p>There are several ways we might evaluate an estimate model. In this
case study, we’ll focus on two: absolute model fit and classification
reliability.</p>
<div class="section level3">
<h3 id="absolute-model-fit">Absolute Model Fit<a class="anchor" aria-label="anchor" href="#absolute-model-fit"></a>
</h3>
<p>One of the most common measures of model fit for DCMs is the
M<sub>2</sub> statistic. This index is a limited information
goodness-of-fit measure originally described by Maydeu-Olivares &amp;
Joe <span class="citation">(<a href="#ref-m2-2005">2005</a>, <a href="#ref-m2-2006">2006</a>)</span> and adapted for DCMs by <span class="citation">Y. Liu et al. (<a href="#ref-liu2016">2016</a>)</span>.
We can calculate the M<sub>2</sub> for a model estimated with measr with
<code><a href="https://rdrr.io/pkg/dcm2/man/fit_m2.html" class="external-link">fit_m2()</a></code>. In addition to the calculated M<sub>2</sub>
statistic, <code><a href="https://rdrr.io/pkg/dcm2/man/fit_m2.html" class="external-link">fit_m2()</a></code> also returns the root mean square error
of approximation (RMSEA) with an associated confidence interval and the
standardized root mean square residual (SRMSR).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/dcm2/man/fit_m2.html" class="external-link">fit_m2</a></span><span class="op">(</span><span class="va">ecpe_lcdm</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 8</span></span></span>
<span><span class="co">#&gt;      m2    df     pval  rmsea ci_lower ci_upper `90% CI`          srmsr</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  513.   325 1.32<span style="color: #949494;">e</span><span style="color: #BB0000;">-10</span> 0.014<span style="text-decoration: underline;">1</span>   0.011<span style="text-decoration: underline;">7</span>   0.016<span style="text-decoration: underline;">3</span> [0.0117, 0.0163] 0.032<span style="text-decoration: underline;">0</span></span></span></code></pre></div>
<p>For our estimated LCDM, we see an M<sub>2</sub> value of 512.9, which
has a corresponding <em>p</em>-value of &lt;.01. When interpreting the
M<sub>2</sub> and its <em>p</em>-value, the null hypothesis is that the
model fits. Thus, the <em>p</em>-value represents the probability of
observing an M<sub>2</sub> value this large if the model fits. For our
estimated LCDM, the <em>p</em>-value is extremely small, indicating that
our model has poor fit.</p>
<p>As described in the <a href="../model-evaluation.html">model
evaluation vignette</a>, a fully Bayesian estimation allows us to
evaluate model fit using posterior predictive model checks (PPMCs).
Specifically, measr supports a PPMC of the overall raw score
distribution as described by <span class="citation">Park et al. (<a href="#ref-park2015">2015</a>)</span> and <span class="citation">Thompson (<a href="#ref-thompson2019">2019</a>)</span>.
For each of the replicated data sets, we calculate the number of
students with each raw score (i.e., the number of correct responses).
This can be done using <code><a href="../reference/fit_ppmc.html">fit_ppmc()</a></code>. Note that we can also
calculate item-level PPMCs. However, because in this case study we are
only interested in overall model fit, we’ll set
<code>item_fit = NULL</code> to save some computation time.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rawscore_ppmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_ppmc.html">fit_ppmc</a></span><span class="op">(</span><span class="va">ecpe_lcdm</span>, model_fit <span class="op">=</span> <span class="st">"raw_score"</span>,</span>
<span>                          return_draws <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span><span class="va">rawscore_ppmc</span></span>
<span><span class="co">#&gt; $ppmc_raw_score</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 7</span></span></span>
<span><span class="co">#&gt;   obs_chisq ppmc_mean `2.5%` `97.5%` rawscore_samples chisq_samples    ppp</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>      930.      28.8   12.3    58.6 <span style="color: #949494;">&lt;tibble&gt;</span>         <span style="color: #949494;">&lt;dbl [500]&gt;</span>   0.000<span style="text-decoration: underline;">5</span></span></span></code></pre></div>
<p>In the output, the posterior predictive <em>p</em>-value
(<em>ppp</em>) is very small, indicating poor fit. To unpack what this
really means, let’s visualize the PPMC. In the following figure, the
blue bars show the credible intervals for the number of respondents we
would expect to see at each raw score point, given our estimated model
parameters. The red dots and line indicate the number of respondents
that were observed at each raw score point in our observed data
(<code>ecpe_data</code>). For example, the model expects there to be
between about 110 and 160 respondents with a total score of 14. In the
observed data, there were 92 respondents with a total score of 14. In
general, the model tends to overestimate the number of respondents with
a raw score between 14–16 and 23–25. On the other hand, the model
underestimates the number of respondents with a raw score between 6–10
and 27–28.</p>
<details><summary>
Plot code
</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/ggdist/" class="external-link">ggdist</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">obs_scores</span> <span class="op">&lt;-</span> <span class="va">ecpe_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="st">"resp_id"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>raw_score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, .by <span class="op">=</span> <span class="va">resp_id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">raw_score</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/complete.html" class="external-link">complete</a></span><span class="op">(</span>raw_score <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">28</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">0L</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rawscore_ppmc</span><span class="op">$</span><span class="va">ppmc_raw_score</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">rawscore_samples</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">rawscore_samples</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">raw_scores</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/stat_interval.html" class="external-link">stat_interval</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">raw_score</span>, y <span class="op">=</span> <span class="va">n</span>, color_ramp <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">level</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                point_interval <span class="op">=</span> <span class="st">"mean_qi"</span>,</span>
<span>                color <span class="op">=</span> <span class="va">msr_colors</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, linewidth <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                show.legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>color <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">obs_scores</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">raw_score</span>, y <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>            color <span class="op">=</span> <span class="va">msr_colors</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">obs_scores</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">raw_score</span>, y <span class="op">=</span> <span class="va">n</span>, fill <span class="op">=</span> <span class="st">"Observed Data"</span><span class="op">)</span>,</span>
<span>             shape <span class="op">=</span> <span class="fl">21</span>, color <span class="op">=</span> <span class="va">msr_colors</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/scale_colour_ramp.html" class="external-link">scale_color_ramp_discrete</a></span><span class="op">(</span>from <span class="op">=</span> <span class="st">"white"</span>, range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                            breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>                            labels <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%0.2f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">msr_colors</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">28</span>, <span class="fl">2</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_comma</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Raw score"</span>, y <span class="op">=</span> <span class="st">"Respondents"</span>,</span>
<span>       color_ramp <span class="op">=</span> <span class="st">"Credible Interval"</span>, fill <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><p><img src="ecpe_files/figure-html/rawscore-dist-1.png" alt="Line plot showing the observed number of respondents at each raw score point, superimposed over an interval showing the expected number of respondents at each score point according to the estimated model." width="90%" style="display: block; margin: auto;"></p>
<p>We can quantify how different the observed raw score distribution is
from the replicated data sets by calculating a χ<sup>2</sup>-like
statistic. To do this, we first calculate the expected number of
students at each raw score by taking the mean of the posterior
distribution for each score point. Then, for each replicated data set,
we calculate χ<sup>2</sup>-like statistic as</p>
<p><span class="math display">
\chi^2_{rep} = \sum_{s=0}^S \frac{[n_s - E(n_s)]^2}{E(n_s)},
</span></p>
<p>where <em>s</em> represents the raw score, <em>n<sub>s</sub></em> is
the number of respondents at score point <em>s</em>, and
<em>E(n<sub>s</sub>)</em> is the expected number of respondents at score
point <em>s</em> (i.e., the mean of the posterior distribution). This
calculation is completed on each of the replicated data sets, creating a
posterior distribution of χ<sup>2</sup><sub>rep</sub> that represents
the plausible values for the χ<sup>2</sup>-like statistic if our model
is correct. This distribution is summarized in the
<code><a href="../reference/fit_ppmc.html">fit_ppmc()</a></code> output. Specifically, we expect the
χ<sup>2</sup>-like statistic for our observed data to be between 12 and
59, as shown in the following figure. However, when we calculate the
statistic on our observed data, we get a value of 930, way beyond our
expected range. This is represented by the <em>ppp</em> value, which is
the proportion of χ<sup>2</sup><sub>rep</sub> values that are larger
than our observed value. In this case, no values of
χ<sup>2</sup><sub>rep</sub> were larger than our observed value, leading
to a <em>ppp</em> of 0.</p>
<details><summary>
Plot code
</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rawscore_ppmc</span><span class="op">$</span><span class="va">ppmc_raw_score</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">chisq_samples</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">chisq_samples</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">chisq_samples</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/stat_dots.html" class="external-link">stat_dots</a></span><span class="op">(</span>quantiles <span class="op">=</span> <span class="fl">500</span>, layout <span class="op">=</span> <span class="st">"hex"</span>, stackratio <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>            color <span class="op">=</span> <span class="va">msr_colors</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, fill <span class="op">=</span> <span class="va">msr_colors</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>            na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="cn">NULL</span>, x <span class="op">=</span> <span class="st">"&amp;chi;^2^&lt;sub&gt;rep&lt;/sub&gt;"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><p><img src="ecpe_files/figure-html/chisq-dist-1.png" alt="Dot plot showing the distribution of chi-square values from the replicated data sets." width="90%" style="display: block; margin: auto;"></p>
<p>In summary, both the M<sub>2</sub> and raw score PPMC indicate poor
fit of our estimated LCDM to the observed data. This is not unexpected,
given that some classes are very small. Recall from our discussion of
the estimated structural parameters that there are three classes that
combine to include less than 4% of all respondents. When classes are
this small, parameter estimates can be unstable, leading to poor model
fit <span class="citation">(e.g., <a href="#ref-hu2020">Hu &amp;
Templin, 2020</a>; <a href="#ref-ma2023">Ma et al., 2023</a>; <a href="#ref-martinez2023">Martinez &amp; Templin, 2023</a>; <a href="#ref-hdcm">Templin &amp; Bradshaw, 2014</a>; <a href="#ref-wang2021">Wang &amp; Lu, 2021</a>)</span>.</p>
</div>
<div class="section level3">
<h3 id="classification-reliability">Classification Reliability<a class="anchor" aria-label="anchor" href="#classification-reliability"></a>
</h3>
<p>Depending on the intended uses of our assessment, we may be less
concerned with overall model fit and more concerned with the consistency
and accuracy of classifications. In other words, we may be focused on
the reliability of the classifications produced by our model. There are
several ways to evaluate the reliability evidence for DCMs. For a
comprehensive summary of methods, see <span class="citation">Sinharay
&amp; Johnson (<a href="#ref-reliability-handbook">2019</a>)</span>.
Using measr, we can easily calculate a wide variety of reliability
metrics for our estimated LCDM using <code><a href="../reference/reliability.html">reliability()</a></code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ecpe_reliability</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reliability.html">reliability</a></span><span class="op">(</span><span class="va">ecpe_lcdm</span><span class="op">)</span></span>
<span><span class="va">ecpe_reliability</span></span>
<span><span class="co">#&gt; $pattern_reliability</span></span>
<span><span class="co">#&gt;       p_a       p_c </span></span>
<span><span class="co">#&gt; 0.7387898 0.6635520 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $map_reliability</span></span>
<span><span class="co">#&gt; $map_reliability$accuracy</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 8</span></span></span>
<span><span class="co">#&gt;   attribute         acc lambda_a kappa_a youden_a tetra_a  tp_a  tn_a</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> morphosyntactic 0.896    0.729   0.787    0.775   0.942 0.851 0.924</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> cohesive        0.852    0.674   0.703    0.699   0.892 0.876 0.823</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> lexical         0.916    0.750   0.609    0.802   0.959 0.947 0.855</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $map_reliability$consistency</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 10</span></span></span>
<span><span class="co">#&gt;   attribute   consist lambda_c kappa_c youden_c tetra_c  tp_c  tn_c gammak</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> morphosynt…   0.834    0.556   0.684    0.646   0.853 0.778 0.868  0.852</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> cohesive      0.806    0.562   0.681    0.607   0.816 0.826 0.781  0.789</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> lexical       0.856    0.553   0.626    0.670   0.875 0.894 0.776  0.880</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: pc_prime &lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $eap_reliability</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   attribute       rho_pf rho_bs rho_i rho_tb</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> morphosyntactic  0.734  0.687 0.573  0.884</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> cohesive         0.728  0.574 0.505  0.785</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> lexical          0.758  0.730 0.587  0.915</span></span></code></pre></div>
<p>By default, <code><a href="../reference/reliability.html">reliability()</a></code> returns several different
types of reliability evidence. For all types of evidence, the indices
range from 0–1, with values close to 1 indicating high accuracy or
consistency. Which information is most relevant will depend on how
scores are determined and reported. For example, we could determine each
respondent’s scores by choosing the overall profile that is most
consistent with their observed responses (i.e., the class probabilities
returned by <code><a href="../reference/score.html">score()</a></code>). For this type of classification we
would want to look at pattern reliability, as we are classifying
responding into an overall pattern of proficiency on the attributes.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ecpe_reliability</span><span class="op">$</span><span class="va">pattern_reliability</span></span>
<span><span class="co">#&gt;       p_a       p_c </span></span>
<span><span class="co">#&gt; 0.7387898 0.6635520</span></span></code></pre></div>
<p>The values <code>p_a</code> and <code>p_c</code> are described by
<span class="citation">Cui et al. (<a href="#ref-cui2012">2012</a>)</span>. <em>P<sub>a</sub></em> is the
probability classifying a random respondent into the correct class, and
<em>P<sub>c</sub></em> is the probability of consistently classifying a
random respondent into the same class across two test
administrations.</p>
<p>On the other hand, rather than basing results on the overall most
likely profile, we could score each attribute individually (i.e., the
attribute probabilities returned by <code><a href="../reference/score.html">score()</a></code>). This is
accomplished by calculating the probability of proficiency on each
attribute and creating classifications based on a given threshold
(usually .5). This result is known as the <em>maximum a posteriori</em>
(MAP) because it represents the most likely latent state for each
respondent on each attribute. As with the pattern-level classifications,
attribute level classifications can be evaluated through accuracy and
consistency. <span class="citation">Johnson &amp; Sinharay (<a href="#ref-johnson2018">2018</a>)</span> developed accuracy
(<code>acc</code>) and consistency (<code>consist</code>) metrics for
attribute level classifications, and also examined other agreement
measures based on contingency tables such as Goodman &amp; Kruskal’s λ,
Cohen’s κ, Youden’s <em>J</em>, the true positive rate, and the true
negative rate.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ecpe_reliability</span><span class="op">$</span><span class="va">map_reliability</span></span>
<span><span class="co">#&gt; $accuracy</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 8</span></span></span>
<span><span class="co">#&gt;   attribute         acc lambda_a kappa_a youden_a tetra_a  tp_a  tn_a</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> morphosyntactic 0.896    0.729   0.787    0.775   0.942 0.851 0.924</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> cohesive        0.852    0.674   0.703    0.699   0.892 0.876 0.823</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> lexical         0.916    0.750   0.609    0.802   0.959 0.947 0.855</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $consistency</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 10</span></span></span>
<span><span class="co">#&gt;   attribute   consist lambda_c kappa_c youden_c tetra_c  tp_c  tn_c gammak</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> morphosynt…   0.834    0.556   0.684    0.646   0.853 0.778 0.868  0.852</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> cohesive      0.806    0.562   0.681    0.607   0.816 0.826 0.781  0.789</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> lexical       0.856    0.553   0.626    0.670   0.875 0.894 0.776  0.880</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: pc_prime &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Using the cutoffs recommended by <span class="citation">Johnson &amp;
Sinharay (<a href="#ref-johnson2018">2018</a>)</span>, the cohesive
rules attribute has <em>fair</em> accuracy while the morphosyntactic and
lexical rules attributes have <em>good</em> accuracy. All attributes
have <em>fair</em> classification consistency.</p>
<p>Finally, results could be reported as probabilities of proficiency on
each attribute, rather than a categorical classification. In this
instance, because the probabilities themselves are reported, we would
want to report the reliability or precision of that probability
estimate. This type of result is known as the <em>expected a
posteriori</em> (EAP) estimate because it is the expected value of the
classification. <span class="citation">Johnson &amp; Sinharay (<a href="#ref-johnson2020">2020</a>)</span> described four metrics for
evaluating the reliability of the EAP estimates: (1) biserial, (2)
informational, (3) parallel forms, and (4) a constrained parallel forms
originally proposed by <span class="citation">Templin &amp; Bradshaw (<a href="#ref-templin2013">2013</a>)</span>. In their paper, <span class="citation">Johnson &amp; Sinharay (<a href="#ref-johnson2020">2020</a>)</span> note that both types of
parallel form reliability tend to over estimate the reliability, and
therefore recommend using the biserial or informational reliability
metrics. These metrics are available in the reliability output as
<code>rho_bs</code> and <code>rho_i</code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ecpe_reliability</span><span class="op">$</span><span class="va">eap_reliability</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   attribute       rho_pf rho_bs rho_i rho_tb</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> morphosyntactic  0.734  0.687 0.573  0.884</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> cohesive         0.728  0.574 0.505  0.785</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> lexical          0.758  0.730 0.587  0.915</span></span></code></pre></div>
<p>Using the cutoffs suggested by <span class="citation">Johnson &amp;
Sinharay (<a href="#ref-johnson2020">2020</a>)</span>, all three
attributes have <em>poor</em> EAP reliability. It’s not surprising that
the EAP reliability is lower than MAP reliability, as it is harder to
place respondents at a specific point on a scale (i.e., the probability
scale) than it is to place respondents into a category. For example,
let’s return to our example of respondent 73.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resp_probs</span><span class="op">$</span><span class="va">attribute_probabilities</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">resp_id</span> <span class="op">==</span> <span class="fl">73</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   resp_id attribute       probability `2.5%` `97.5%`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 73      morphosyntactic       0.416  0.269   0.570</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 73      cohesive              0.761  0.644   0.855</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 73      lexical               0.933  0.881   0.967</span></span></code></pre></div>
<p>We estimated that there is a 93% chance that this respondent was
proficient on lexical rules. However, the credible interval tells us
this probability could be anywhere from 88% to 97%. There’s a nine
percentage point range that is plausible. We don’t have a great deal of
certainty for the specific probability that the respondent is proficient
in lexical rules; however, the entire plausible range is high, so we
would make a classification of “proficient” regardless of where in the
range the true probability of proficiency is. That is, we would
consistently make the same classification decision, regardless of the
uncertainty in the probability itself.</p>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>In this case study, we estimated an LCDM to analyze the ECPE data.
From the model estimation, we saw that the estimates provided by measr
were highly consistent with previously reported parameters estimates for
the ECPE. However, model fit indices indicated that the LCDM does not do
a great job of represented the observed data. This is likely due to
dependencies among the attributes. To further analyze this data, we
might consider a model with a different attribute structure, such as the
hierarchical diagnostic classification model <span class="citation">(<a href="#ref-hdcm">Templin &amp; Bradshaw, 2014</a>)</span>. Despite the
poor model fit, reliability indices showed that classification
consistency and accuracy were generally in the fair to good range, and
therefore, depending on our intended uses, this model may be sufficient
for reporting respondent proficiency of the three attributes.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-bradshaw-2019" class="csl-entry">
Bradshaw, L., &amp; Levy, R. (2019). Interpreting probabilistic
classifications from diagnostic psychometric models. <em>Educational
Measurement: Issues and Practice</em>, <em>38</em>(2), 79–88. <a href="https://doi.org/10.1111/emip.12247" class="external-link">https://doi.org/10.1111/emip.12247</a>
</div>
<div id="ref-chen2018" class="csl-entry">
Chen, F., Liu, Y., Xin, T., &amp; Cui, Y. (2018). Applying the <span class="math inline">{M}_2</span> statistic to evaluate the fit of
diagnostic classification models in the presence of attribute
hierarchies. <em>Frontiers in Psychology</em>, <em>9</em>. <a href="https://doi.org/10.3389/fpsyg.2018.01875" class="external-link">https://doi.org/10.3389/fpsyg.2018.01875</a>
</div>
<div id="ref-cui2012" class="csl-entry">
Cui, Y., Gierl, M. J., &amp; Chang, H.-H. (2012). Estimating
classification consistency and accuracy for cognitive diagnostic
assessment. <em>Journal of Educational Measurement</em>, <em>49</em>(1),
19–38. <a href="https://doi.org/10.1111/j.1745-3984.2011.00158.x" class="external-link">https://doi.org/10.1111/j.1745-3984.2011.00158.x</a>
</div>
<div id="ref-lcdm-handbook" class="csl-entry">
Henson, R., &amp; Templin, J. (2019). Loglinear cognitive diagnostic
model (<span>LCDM</span>). In M. von Davier &amp; Y.-S. Lee (Eds.),
<em>Handbook of <span>Diagnostic Classification Models</span></em> (pp.
171–185). <span>Springer International Publishing</span>. <a href="https://doi.org/10.1007/978-3-030-05584-4_8" class="external-link">https://doi.org/10.1007/978-3-030-05584-4_8</a>
</div>
<div id="ref-lcdm" class="csl-entry">
Henson, R., Templin, J., &amp; Willse, J. T. (2009). Defining a family
of cognitive diagnosis models using log-linear models with latent
variables. <em>Psychometrika</em>, <em>74</em>(2), 191–210. <a href="https://doi.org/10.1007/s11336-008-9089-5" class="external-link">https://doi.org/10.1007/s11336-008-9089-5</a>
</div>
<div id="ref-hu2020" class="csl-entry">
Hu, B., &amp; Templin, J. (2020). Using diagnostic classification models
to validate attribute hierarchies and evaluate model fit in
<span>Bayesian</span> networks. <em>Multivariate Behavioral
Research</em>, <em>55</em>(2), 300–311. <a href="https://doi.org/10.1080/00273171.2019.1632165" class="external-link">https://doi.org/10.1080/00273171.2019.1632165</a>
</div>
<div id="ref-johnson2018" class="csl-entry">
Johnson, M. S., &amp; Sinharay, S. (2018). Measures of agreement to
assess attribute-level classification accuracy and consistency for
cognitive diagnostic assessments. <em>Journal of Educational
Measurement</em>, <em>55</em>(4), 635–664. <a href="https://doi.org/10.1111/jedm.12196" class="external-link">https://doi.org/10.1111/jedm.12196</a>
</div>
<div id="ref-johnson2020" class="csl-entry">
Johnson, M. S., &amp; Sinharay, S. (2020). The reliability of the
posterior probability of skill attainment in diagnostic classification
models. <em>Journal of Educational and Behavioral Statistics</em>,
<em>45</em>(1), 5–31. <a href="https://doi.org/10.3102/1076998619864550" class="external-link">https://doi.org/10.3102/1076998619864550</a>
</div>
<div id="ref-mcmc-handbook" class="csl-entry">
Liu, X., &amp; Johnson, M. S. (2019). Estimating <span>CDMs</span> using
<span>MCMC</span>. In M. von Davier &amp; Y.-S. Lee (Eds.), <em>Handbook
of <span>Diagnostic Classification Models</span></em> (pp. 629–646).
<span>Springer International Publishing</span>. <a href="https://doi.org/10.1007/978-3-030-05584-4_31" class="external-link">https://doi.org/10.1007/978-3-030-05584-4_31</a>
</div>
<div id="ref-liu2016" class="csl-entry">
Liu, Y., Tian, W., &amp; Xin, T. (2016). An application of <span><span class="math inline">M_2</span></span> statistic to evaluate the fit of
cognitive diagnostic models. <em>Journal of Educational and Behavioral
Statistics</em>, <em>41</em>(1), 3–26. <a href="https://doi.org/10.3102/1076998615621293" class="external-link">https://doi.org/10.3102/1076998615621293</a>
</div>
<div id="ref-ma2023" class="csl-entry">
Ma, C., Ouyang, J., &amp; Xu, G. (2023). Learning latent and
hierarchical structures in cognitive diagnosis models.
<em>Psychometrika</em>, <em>88</em>, 175–207. <a href="https://doi.org/10.1007/s11336-022-09867-5" class="external-link">https://doi.org/10.1007/s11336-022-09867-5</a>
</div>
<div id="ref-martinez2023" class="csl-entry">
Martinez, A. J., &amp; Templin, J. (2023). Approximate invariance
testing in diagnostic classification models in the presence of attribute
hierarchies: A <span>Bayesian</span> network approach. <em>Psych</em>,
<em>5</em>(3), 688–714. <a href="https://doi.org/10.3390/psych5030045" class="external-link">https://doi.org/10.3390/psych5030045</a>
</div>
<div id="ref-m2-2005" class="csl-entry">
Maydeu-Olivares, A., &amp; Joe, H. (2005). Limited- and full-information
estimation and goodness-of-fit testing in <span class="math inline">2^n</span> contingency tables: <span>A</span>
unified framework. <em>Journal of the American Statistical
Association</em>, <em>100</em>(471), 1009–1020. <a href="https://doi.org/10.1198/016214504000002069" class="external-link">https://doi.org/10.1198/016214504000002069</a>
</div>
<div id="ref-m2-2006" class="csl-entry">
Maydeu-Olivares, A., &amp; Joe, H. (2006). Limited information
goodness-of-fit testing in multidimensional contingency tables.
<em>Psychometrika</em>, <em>71</em>(4), 713–732. <a href="https://doi.org/10.1007/s11336-005-1295-9" class="external-link">https://doi.org/10.1007/s11336-005-1295-9</a>
</div>
<div id="ref-park2015" class="csl-entry">
Park, J. Y., Johnson, M. S., &amp; Lee, Y.-S. (2015). Posterior
predictive model checks for cognitive diagnostic models.
<em>International Journal of Quantitative Research in Education</em>,
<em>2</em>(3–4), 244–264. <a href="https://doi.org/10.1504/IJQRE.2015.071738" class="external-link">https://doi.org/10.1504/IJQRE.2015.071738</a>
</div>
<div id="ref-reliability-handbook" class="csl-entry">
Sinharay, S., &amp; Johnson, M. S. (2019). Measures of agreement:
<span>Reliability</span>, classification accuracy, and classification
consistency. In M. von Davier &amp; Y.-S. Lee (Eds.), <em>Handbook of
<span>Diagnostic Classification Models</span></em> (pp. 359–377).
<span>Springer International Publishing</span>. <a href="https://doi.org/10.1007/978-3-030-05584-4_17" class="external-link">https://doi.org/10.1007/978-3-030-05584-4_17</a>
</div>
<div id="ref-templin2013" class="csl-entry">
Templin, J., &amp; Bradshaw, L. (2013). Measuring the reliability of
diagnostic classification model examinee estimates. <em>Journal of
Classification</em>, <em>30</em>(2), 251–275. <a href="https://doi.org/10.1007/s00357-013-9129-4" class="external-link">https://doi.org/10.1007/s00357-013-9129-4</a>
</div>
<div id="ref-hdcm" class="csl-entry">
Templin, J., &amp; Bradshaw, L. (2014). Hierarchical diagnostic
classification models: <span>A</span> family of models for estimating
and testing attribute hierarchies. <em>Psychometrika</em>,
<em>79</em>(2), 317–339. <a href="https://doi.org/10.1007/s11336-013-9362-0" class="external-link">https://doi.org/10.1007/s11336-013-9362-0</a>
</div>
<div id="ref-templin-emip-2013" class="csl-entry">
Templin, J., &amp; Hoffman, L. (2013). Obtaining diagnostic
classification model estimates using Mplus. <em>Educational Measurement:
Issues and Practice</em>, <em>32</em>(2), 37–50. <a href="https://doi.org/10.1111/emip.12010" class="external-link">https://doi.org/10.1111/emip.12010</a>
</div>
<div id="ref-thompson2019" class="csl-entry">
Thompson, W. J. (2019). <em>Bayesian psychometrics for diagnostic
assessments: <span>A</span> proof of concept</em> (Research Report No.
19-01). <span>University of Kansas; Accessible Teaching, Learning, and
Assessment Systems</span>. <a href="https://doi.org/10.35542/osf.io/jzqs8" class="external-link">https://doi.org/10.35542/osf.io/jzqs8</a>
</div>
<div id="ref-thompson-ame" class="csl-entry">
Thompson, W. J., Clark, A. K., &amp; Nash, B. (2019). Measuring the
reliability of diagnostic mastery classifications at multiple levels of
reporting. <em>Applied Measurment in Education</em>, <em>32</em>(4),
298–309. <a href="https://doi.org/10.1080/08957347.2019.1660345" class="external-link">https://doi.org/10.1080/08957347.2019.1660345</a>
</div>
<div id="ref-wang2021" class="csl-entry">
Wang, C., &amp; Lu, J. (2021). Learning attribute hierarchies form data:
Two exploratory approaches. <em>Journal of Educational and Behavioral
Statistics</em>, <em>46</em>(1), 58–84. <a href="https://doi.org/10.3102/1076998620931094" class="external-link">https://doi.org/10.3102/1076998620931094</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://wjakethompson.com" class="external-link">W. Jake Thompson</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
