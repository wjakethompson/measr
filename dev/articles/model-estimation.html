<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Estimating diagnostic classification models • measr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Open_Sans-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Fira_Code-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Playfair_Display-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimating diagnostic classification models">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">measr</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.0.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/measr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/paper.html">measr: Bayesian psychometric measurement using Stan</a></li>
    <li><a class="dropdown-item" href="../articles/model-estimation.html">Estimating diagnostic classification models</a></li>
    <li><a class="dropdown-item" href="../articles/model-evaluation.html">Evaluating diagnostic classification models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Case Studies</h6></li>
    <li><a class="dropdown-item" href="../articles/ecpe.html">Examination for the Certificate of Proficiency in English</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.wjakethompson.com/blog/measr/2024-02-measr-1.0.0/">Version 1.0.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.wjakethompson.com/blog/measr/2023-06-measr-0.3.1/">Version 0.3.1</a></li>
    <li><a class="external-link dropdown-item" href="https://www.wjakethompson.com/blog/measr/2023-04-measr-0.2.1/">Version 0.2.1</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/wjakethompson/measr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimating diagnostic classification models</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/wjakethompson/measr/blob/main/vignettes/articles/model-estimation.Rmd" class="external-link"><code>vignettes/articles/model-estimation.Rmd</code></a></small>
      <div class="d-none name"><code>model-estimation.Rmd</code></div>
    </div>

    
    
<p>In this article, we will walk you through the steps for estimating
diagnostic classification models (DCMs; also known as cognitive
diagnostic models [CDMs]) using measr. We start with the data to
analyze, understand how to specify a DCM to estimate, and learn how to
customize the model estimation process (e.g., prior distributions).</p>
<p>To use the code in this article, you will need to install and load
the measr package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://measr.info">measr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'measr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     optim</span></span></code></pre></div>
<div class="section level2">
<h2 id="example-data">Example Data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h2>
<p>To demonstrate the model estimation functionality of measr, we’ll
examine a simulated data set. This data set contains 2,000 respondents
and 20 items that measure a total of 4 attributes, but no item measures
more than 2 attributes. The data was generated from the loglinear
cognitive diagnostic model (LCDM), which is a general model that
subsumes many other DCM subtypes <span class="citation">(<a href="#ref-lcdm">Henson et al., 2009</a>)</span>. By using a simulated
data set, we can compare the parameter estimates from measr to the true
data generating parameters.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">read_rds</a></span><span class="op">(</span><span class="st">"data/simulated-data.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_data</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,000 × 21</span></span></span>
<span><span class="co">#&gt;    resp_id    A1    A2    A3    A4    A5    A6    A7    A8    A9   A10</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>       1     1     1     0     1     0     0     0     0     1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>       2     1     1     1     0     0     1     0     1     1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>       3     1     1     1     1     1     0     1     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>       4     1     0     1     0     0     1     0     1     1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>       5     1     1     0     0     0     0     0     1     1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>       6     1     1     1     0     1     0     0     1     1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>       7     1     0     1     0     0     1     0     1     1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>       8     0     1     1     0     0     1     0     1     1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>       9     1     1     1     0     0     1     1     1     1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      10     1     1     1     0     1     1     0     1     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,990 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 10 more variables: A11 &lt;int&gt;, A12 &lt;int&gt;, A13 &lt;int&gt;, A14 &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   A15 &lt;int&gt;, A16 &lt;int&gt;, A17 &lt;int&gt;, A18 &lt;int&gt;, A19 &lt;int&gt;, A20 &lt;int&gt;</span></span></span>
<span></span>
<span><span class="va">sim_data</span><span class="op">$</span><span class="va">q_matrix</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 5</span></span></span>
<span><span class="co">#&gt;    item_id  att1  att2  att3  att4</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> A1          0     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> A2          0     0     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> A3          1     1     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> A4          1     0     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> A5          1     0     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> A6          0     1     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> A7          1     0     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> A8          0     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> A9          0     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> A10         1     0     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> A11         1     0     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> A12         0     0     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> A13         0     0     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> A14         0     0     1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> A15         0     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> A16         0     1     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> A17         0     0     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> A18         1     0     1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> A19         0     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> A20         0     0     0     1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="specifying-a-dcm-for-estimation">Specifying a DCM for Estimation<a class="anchor" aria-label="anchor" href="#specifying-a-dcm-for-estimation"></a>
</h2>
<p>In measr, DCMs are specified and estimated using the
<code><a href="https://dcmstan.r-dcm.org/reference/dcm_specify.html" class="external-link">dcm_specify()</a></code> and <code><a href="../reference/dcm_estimate.html">dcm_estimate()</a></code> functions,
respectively. We’ll start by estimating a loglinear cognitive diagnostic
model (LCDM). The LCDM is a general DCM that subsumes many other DCM
subtypes <span class="citation">(<a href="#ref-lcdm">Henson et al.,
2009</a>)</span>.</p>
<p>First, we specify the model using our Q-matrix
(<code>qmatrix</code>). Note that this is the only required argument to
the <code><a href="https://dcmstan.r-dcm.org/reference/dcm_specify.html" class="external-link">dcm_specify()</a></code> function. If no other arguments are
provided, sensible defaults (described below) will take care of the rest
of the specification. Next, we can specify which column, if any, in our
<code>qmatrix</code> contains item identifiers. If this variables is not
present in the data, this argument can be omitted, and measr will assign
identifiers based on the row number (i.e., row 1 in <code>qmatrix</code>
becomes item 1). We can then specify the type of DCM we want to
estimate. Here, we’ll choose the LCDM for our measurement model, and
we’ll use an unconstrained structural model.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;For more details on the modeling options, see &lt;a href="#subtype"&gt;Estimating Other DCM Sub-Types&lt;/a&gt; below.&lt;/p&gt;'><sup>1</sup></a></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dcmstan.r-dcm.org/reference/dcm_specify.html" class="external-link">dcm_specify</a></span><span class="op">(</span>qmatrix <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">q_matrix</span>, identifier <span class="op">=</span> <span class="st">"item_id"</span>,</span>
<span>                          measurement_model <span class="op">=</span> <span class="fu"><a href="https://dcmstan.r-dcm.org/reference/measurement-model.html" class="external-link">lcdm</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                          structural_model <span class="op">=</span> <span class="fu"><a href="https://dcmstan.r-dcm.org/reference/structural-model.html" class="external-link">unconstrained</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_spec</span></span>
<span><span class="co">#&gt; A loglinear cognitive diagnostic model (LCDM) measuring 4 attributes with</span></span>
<span><span class="co">#&gt; 20 items.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Attributes:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="color: #0000BB;">"att1"</span> (7 items)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="color: #0000BB;">"att2"</span> (8 items)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="color: #0000BB;">"att3"</span> (5 items)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> <span style="color: #0000BB;">"att4"</span> (13 items)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Attribute structure:</span></span>
<span><span class="co">#&gt;   Unconstrained</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Prior distributions:</span></span>
<span><span class="co">#&gt;   <span style="font-style: italic;">intercept</span> ~ normal(0, 2)</span></span>
<span><span class="co">#&gt;   <span style="font-style: italic;">maineffect</span> ~ lognormal(0, 1)</span></span>
<span><span class="co">#&gt;   <span style="font-style: italic;">interaction</span> ~ normal(0, 2)</span></span>
<span><span class="co">#&gt;   `Vc` ~ dirichlet(1, 1, 1, 1)</span></span></code></pre></div>
<p>We can then pass this model specification to
<code><a href="../reference/dcm_estimate.html">dcm_estimate()</a></code>, along with our data (<code>data</code>). As
with the model specification, we can specify which column, if any,
contains respondent identifiers in the <code>data</code> object. For the
model estimation, we have the option to choose which engine to use, via
the <code>backend</code> argument. The default backend is
<code>backend = "rstan"</code>, which will use the <a href="https://mc-stan.org/rstan/" class="external-link">rstan</a> package to estimate the
model. Alternatively, we can use the <a href="https://mc-stan.org/cmdstanr/" class="external-link">cmdstanr</a> package to estimate
the model by specifying <code>backend = "cmdstanr"</code>. The cmdstanr
package works by using a local installation of <em>Stan</em> to estimate
the models, rather than the version that is pre-compiled in rstan. Once
a backend has been chosen, we can supply additional arguments to those
specific estimating functions. In the example below, we specify 1,000
warm-up iterations per chain, 500 post-warm-up iterations per chain, and
4 cores to run the chains in parallel. The full set up options available
for rstan and cmdstanr can be found by looking at the help pages for
<code>?rstan::sampling()</code> and
<code><a href="https://mc-stan.org/cmdstanr/reference/model-method-sample.html" class="external-link">?cmdstanr::`model-method-sample`</a></code>, respectively.</p>
<p>Finally, because estimating these models can be time intensive, we
can specify a <code>file</code>. If a file is specified, an R object of
the fitted model will be automatically saved to the specified file. If
the specified <code>file</code> already exists, then the fitted model
will be read back into R, eliminating the need to re-estimate the
model.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lcdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dcm_estimate.html">dcm_estimate</a></span><span class="op">(</span><span class="va">model_spec</span>, data <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">data</span>, identifier <span class="op">=</span> <span class="st">"resp_id"</span>,</span>
<span>                     method <span class="op">=</span> <span class="st">"mcmc"</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>,</span>
<span>                     iter_warmup <span class="op">=</span> <span class="fl">1000</span>, iter_sampling <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                     chains <span class="op">=</span> <span class="fl">4</span>, parallel_chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                     file <span class="op">=</span> <span class="st">"fits/sim-lcdm"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="examining-parameter-estimates">Examining Parameter Estimates<a class="anchor" aria-label="anchor" href="#examining-parameter-estimates"></a>
</h3>
<p>Now that we’ve estimated a model, let’s compare our parameter
estimates to the true values used to generate the data. We can start be
looking at our estimates using <code><a href="../reference/measr_extract.html">measr_extract()</a></code>. This
function extracts different aspects of a model estimated with measr.
Here, the <code>estimate</code> column reports estimated value for each
parameter and a measure of the associated error (i.e., the standard
deviation of the posterior distribution). For example, item A1 measures
two attributes and therefore has four parameters:</p>
<ol style="list-style-type: decimal">
<li>An intercept, which represents the log-odds of providing a correct
response for a respondent who is proficient in neither of the attributes
this item measures (i.e., <code>att2</code> and <code>att4</code>).</li>
<li>A main effect for the second attribute, which represents the
increase in the log-odds of providing a correct response for a
respondent who is proficient in that attribute.</li>
<li>A main effect for the fourth attribute, which represents the
increase in the log-odds of providing a correct response for a
respondent who is proficient in that attribute.</li>
<li>An interaction between the second and fourth attributes, which is
the change in the log-odds for a respondent who is proficient in both
attributes.</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">item_parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/measr_extract.html">measr_extract</a></span><span class="op">(</span><span class="va">lcdm</span>, what <span class="op">=</span> <span class="st">"item_param"</span><span class="op">)</span></span>
<span><span class="va">item_parameters</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 66 × 5</span></span></span>
<span><span class="co">#&gt;    item_id type        attributes coefficient       estimate</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;rvar[1d]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> A1      intercept   <span style="color: #BB0000;">NA</span>         l1_0         -0.98 <span style="color: #949494;">± 0.099</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> A1      maineffect  att2       l1_12         2.46 <span style="color: #949494;">± 0.154</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> A1      maineffect  att4       l1_14         4.46 <span style="color: #949494;">± 0.313</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> A1      interaction att2__att4 l1_224        0.16 <span style="color: #949494;">± 1.303</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> A2      intercept   <span style="color: #BB0000;">NA</span>         l2_0         -2.41 <span style="color: #949494;">± 0.294</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> A2      maineffect  att3       l2_13         4.00 <span style="color: #949494;">± 0.323</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> A2      maineffect  att4       l2_14         3.82 <span style="color: #949494;">± 0.334</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> A2      interaction att3__att4 l2_234       -3.59 <span style="color: #949494;">± 0.376</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> A3      intercept   <span style="color: #BB0000;">NA</span>         l3_0         -2.01 <span style="color: #949494;">± 0.159</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> A3      maineffect  att1       l3_11         2.22 <span style="color: #949494;">± 0.189</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 56 more rows</span></span></span></code></pre></div>
<p>We can compare these estimates to those that were used to generate
the data. In the figure below, most parameters fall on or very close to
the dashed line, which represents perfect agreement, indicating that the
estimated model is accurately estimating the parameter values.</p>
<p><img src="model-estimation_files/figure-html/lcdm-param-compare-1.png" alt="Figure shows a strong correlation between item parameters, with only a few discrepancies off of the line of perfect agreement." width="90%" style="display: block; margin: auto;"></p>
<p>We can also examine the structural parameters, which represent the
overall proportion of respondents in each class. Again, we see
relatively strong agreement between the estimates from our model and the
true generating values.</p>
<p><img src="model-estimation_files/figure-html/lcdm-strc-compare-1.png" alt="Figure shows a strong correlation between item parameters, with only a few discrepancies off of the line of perfect agreement." width="90%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="customizing-the-model-estimation-process">Customizing the Model Estimation Process<a class="anchor" aria-label="anchor" href="#customizing-the-model-estimation-process"></a>
</h2>
<div class="section level3">
<h3 id="prior-distributions">Prior Distributions<a class="anchor" aria-label="anchor" href="#prior-distributions"></a>
</h3>
<p>In the code to define the LCDM above, we did not specify any prior
distributions in the call to <code><a href="https://dcmstan.r-dcm.org/reference/dcm_specify.html" class="external-link">dcm_specify()</a></code>. By default,
measr uses the following prior distributions for the LCDM:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dcmstan.r-dcm.org/reference/default_dcm_priors.html" class="external-link">default_dcm_priors</a></span><span class="op">(</span>measurement_model <span class="op">=</span> <span class="fu"><a href="https://dcmstan.r-dcm.org/reference/measurement-model.html" class="external-link">lcdm</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 3</span></span></span>
<span><span class="co">#&gt;   type        coefficient prior          </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> intercept   <span style="color: #BB0000;">NA</span>          normal(0, 2)   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> maineffect  <span style="color: #BB0000;">NA</span>          lognormal(0, 1)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> interaction <span style="color: #BB0000;">NA</span>          normal(0, 2)</span></span></code></pre></div>
<p>As you can see, main effect parameters get a
<code>lognormal(0, 1)</code> prior by default. Different prior
distributions can be specified with the <code><a href="https://dcmstan.r-dcm.org/reference/prior.html" class="external-link">prior()</a></code> function.
For example, we can specify a <code>normal(0, 10)</code> prior for the
main effects with:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dcmstan.r-dcm.org/reference/prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"maineffect"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;   type       coefficient prior        </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> maineffect <span style="color: #BB0000;">NA</span>          normal(0, 10)</span></span></code></pre></div>
<p>By default, the prior is applied to all parameters in the class
(i.e., all main effects). However, we can also apply a prior to a
specific parameter. For example, here we specify a χ<sup>2</sup>
distribution with 2 degrees of freedom as the default prior for main
effects, and an exponential distribution with a rate of 2 for the main
effect of attribute 1 on just item 7. To see all parameters (including
<code>type</code> and <code>coefficient</code>) that can be specified,
we can pass our model specification to
<code><a href="https://dcmstan.r-dcm.org/reference/get_parameters.html" class="external-link">get_parameters()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://dcmstan.r-dcm.org/reference/prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu">chi_square</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"maineffect"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://dcmstan.r-dcm.org/reference/prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu">exponential</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"maineffect"</span>, coefficient <span class="op">=</span> <span class="st">"l7_11"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   type       coefficient prior         </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> maineffect <span style="color: #BB0000;">NA</span>          chi_square(2) </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> maineffect l7_11       exponential(2)</span></span>
<span></span>
<span><span class="fu"><a href="https://dcmstan.r-dcm.org/reference/get_parameters.html" class="external-link">get_parameters</a></span><span class="op">(</span><span class="va">model_spec</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 67 × 4</span></span></span>
<span><span class="co">#&gt;    item_id type        attributes coefficient</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> A1      intercept   <span style="color: #BB0000;">NA</span>         l1_0       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> A1      maineffect  att2       l1_12      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> A1      maineffect  att4       l1_14      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> A1      interaction att2__att4 l1_224     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> A2      intercept   <span style="color: #BB0000;">NA</span>         l2_0       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> A2      maineffect  att3       l2_13      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> A2      maineffect  att4       l2_14      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> A2      interaction att3__att4 l2_234     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> A3      intercept   <span style="color: #BB0000;">NA</span>         l3_0       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> A3      maineffect  att1       l3_11      </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 57 more rows</span></span></span></code></pre></div>
<p>Any distribution that is supported by the <em>Stan</em> language can
be used as a prior. A list of all distributions is available in the
<em>Stan</em> documentation, and are linked to from the
<code>?prior()</code> help page.</p>
<p>Priors can be defined before estimating the function, or created at
the same time the model is estimated. For example, both of the following
are equivalent. Here we set the prior for main effects to be a truncated
normal distribution with a lower bound of 0. This is done because the
main effects in the LCDM are constrained to be positive to ensure
monotonicity in the model. Additionally note that I’ve set
<code>method = "optim"</code>. This means that we will estimate the
model using <em>Stan’s</em> optimizer, rather than using full Markov
Chain Monte Carlo. Note that the prior still influences the model when
using <code>method = "optim"</code>, just as they do when using
<code>method = "mcmc"</code> (the default).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dcmstan.r-dcm.org/reference/prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"maineffect"</span>, lower_bound <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">new_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dcmstan.r-dcm.org/reference/dcm_specify.html" class="external-link">dcm_specify</a></span><span class="op">(</span>qmatrix <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">q_matrix</span>, identifier <span class="op">=</span> <span class="st">"item_id"</span>,</span>
<span>                        measurement_model <span class="op">=</span> <span class="fu"><a href="https://dcmstan.r-dcm.org/reference/measurement-model.html" class="external-link">lcdm</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                        structural_model <span class="op">=</span> <span class="fu"><a href="https://dcmstan.r-dcm.org/reference/structural-model.html" class="external-link">unconstrained</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                        priors <span class="op">=</span> <span class="va">new_prior</span><span class="op">)</span></span>
<span></span>
<span><span class="va">new_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dcmstan.r-dcm.org/reference/dcm_specify.html" class="external-link">dcm_specify</a></span><span class="op">(</span>qmatrix <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">q_matrix</span>, identifier <span class="op">=</span> <span class="st">"item_id"</span>,</span>
<span>                        measurement_model <span class="op">=</span> <span class="fu"><a href="https://dcmstan.r-dcm.org/reference/measurement-model.html" class="external-link">lcdm</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                        structural_model <span class="op">=</span> <span class="fu"><a href="https://dcmstan.r-dcm.org/reference/structural-model.html" class="external-link">unconstrained</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                        priors <span class="op">=</span> <span class="fu"><a href="https://dcmstan.r-dcm.org/reference/prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"maineffect"</span>,</span>
<span>                                       lower_bound <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Estimate the updated model</span></span>
<span><span class="va">new_lcdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dcm_estimate.html">dcm_estimate</a></span><span class="op">(</span><span class="va">new_spec</span>, data <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">data</span>, identifier <span class="op">=</span> <span class="st">"resp_id"</span>,</span>
<span>                         method <span class="op">=</span> <span class="st">"optim"</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>,</span>
<span>                         file <span class="op">=</span> <span class="st">"fits/sim-lcdm-optim"</span><span class="op">)</span></span></code></pre></div>
<p>The priors used to estimate the model are saved in the returned model
object, so we can always go back and see which priors were used if we
are unsure. We can see that for the <code>new_lcdm</code> model, our
specified normal prior was used for the main effects, but the default
priors were still applied to the parameters for which we did not
explicitly state a prior distribution.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/measr_extract.html">measr_extract</a></span><span class="op">(</span><span class="va">new_lcdm</span>, <span class="st">"prior"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 3</span></span></span>
<span><span class="co">#&gt;   type        coefficient prior                      </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> maineffect  <span style="color: #BB0000;">NA</span>          normal(0, 15)T[0,]         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> intercept   <span style="color: #BB0000;">NA</span>          normal(0, 2)               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> interaction <span style="color: #BB0000;">NA</span>          normal(0, 2)               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> structural  Vc          dirichlet(rep_vector(1, C))</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="subtype">Other DCM Sub-Types<a class="anchor" aria-label="anchor" href="#subtype"></a>
</h3>
<p>Although a primary motivation for measr is to provide researchers
with software that makes the LCDM readily accessible, a few other
popular DCM subtypes are also supported. For example, we can estimate
the deterministic inputs, noisy “and” gate <span class="citation">(DINA,
<a href="#ref-junker2001">Junker &amp; Sijtsma, 2001</a>)</span> or the
deterministic inputs, noisy “or” gate <span class="citation">(DINO, <a href="#ref-dino">Templin &amp; Henson, 2006</a>)</span> models by
specifying a different <code>measurement_model</code> in the
<code><a href="https://dcmstan.r-dcm.org/reference/dcm_specify.html" class="external-link">dcm_specify()</a></code> function. For a complete list of currently
supported measurement and structural models, see
<code><a href="https://dcmstan.r-dcm.org/reference/measurement-model.html" class="external-link">?dcmstan::`measurement-model`</a></code> and
<code><a href="https://dcmstan.r-dcm.org/reference/structural-model.html" class="external-link">?dcmstan::`structural-model`</a></code>, respectively.</p>
<p>Future development work will continue to add functionality for more
DCM subtypes. If there is a specific subtype you are interested in, or
would like to see supported, please open an issue on the <a href="https://github.com/wjakethompson/measr/issues" class="external-link">GitHub
repository</a>.</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-lcdm" class="csl-entry">
Henson, R., Templin, J., &amp; Willse, J. T. (2009). Defining a family
of cognitive diagnosis models using log-linear models with latent
variables. <em>Psychometrika</em>, <em>74</em>(2), 191–210. <a href="https://doi.org/10.1007/s11336-008-9089-5" class="external-link">https://doi.org/10.1007/s11336-008-9089-5</a>
</div>
<div id="ref-junker2001" class="csl-entry">
Junker, B. W., &amp; Sijtsma, K. (2001). Cognitive assessment models
with few assumptions, and connections with nonparametric item response
theory. <em>Applied Psychological Measurement</em>, <em>25</em>(3),
258–272. <a href="https://doi.org/10.1177/01466210122032064" class="external-link">https://doi.org/10.1177/01466210122032064</a>
</div>
<div id="ref-dino" class="csl-entry">
Templin, J., &amp; Henson, R. A. (2006). Measurement of psychological
disorders using cognitive diagnosis models. <em>Psychological
Methods</em>, <em>11</em>(3), 287–305. <a href="https://doi.org/10.1037/1082-989X.11.3.287" class="external-link">https://doi.org/10.1037/1082-989X.11.3.287</a>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://wjakethompson.com" class="external-link">W. Jake Thompson</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
