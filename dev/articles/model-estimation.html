<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="measr">
<title>Estimating diagnostic classification models • measr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Open_Sans-0.4.7/font.css" rel="stylesheet">
<link href="../deps/Fira_Code-0.4.7/font.css" rel="stylesheet">
<link href="../deps/Playfair_Display-0.4.7/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Estimating diagnostic classification models">
<meta property="og:description" content="measr">
<meta property="og:image" content="https://measr.info/reference/figures/card.png">
<meta property="og:image:alt" content="">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@wjakethompson">
<meta name="twitter:site" content="@atlas4learning">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">measr</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.3.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/measr.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/paper.html">measr: Bayesian psychometric measurement using Stan</a>
    <a class="dropdown-item" href="../articles/model-estimation.html">Estimating diagnostic classification models</a>
    <a class="dropdown-item" href="../articles/model-evaluation.html">Evaluating diagnostic classification models</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <h6 class="dropdown-header" data-toc-skip>Releases</h6>
    <a class="external-link dropdown-item" href="https://www.wjakethompson.com/blog/measr/2023-06-measr-0.3.1/">Version 0.3.1</a>
    <a class="external-link dropdown-item" href="https://www.wjakethompson.com/blog/measr/2023-04-measr-0.2.1/">Version 0.2.1</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../news/index.html">Changelog</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/wjakethompson/measr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimating diagnostic classification models</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/wjakethompson/measr/blob/HEAD/vignettes/articles/model-estimation.Rmd" class="external-link"><code>vignettes/articles/model-estimation.Rmd</code></a></small>
      <div class="d-none name"><code>model-estimation.Rmd</code></div>
    </div>

    
    
<p>In this article, we will walk you through the steps for estimating
diagnostic classification models (DCMs; also known as cognitive
diagnostic models [CDMs]) using measr. We start with the data to
analyze, understand how to specify a DCM to estimate, and learn how to
customize the model estimation process (e.g., prior distributions).</p>
<p>To use the code in this article, you will need to install and load
the measr package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://measr.info">measr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="example-data">Example Data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h2>
<p>To demonstrate the model estimation functionality of measr, we’ll
examine a simulated data set. This data set contains 2,000 respondents
and 20 items that measure a total of 4 attributes, but no item measures
more than 2 attributes. The data was generated from the loglinear
cognitive diagnostic model (LCDM), which is a general model that
subsumes many other DCM subtypes <span class="citation">(<a href="#ref-lcdm" role="doc-biblioref">Henson et al., 2009</a>)</span>.
By using a simulated data set, we can compare the parameter estimates
from measr to the true data generating parameters.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">read_rds</a></span><span class="op">(</span><span class="st">"data/simulated-data.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_data</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,000 × 21</span></span></span>
<span><span class="co">#&gt;    resp_id    A1    A2    A3    A4    A5    A6    A7    A8    A9   A10   A11</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>       1     1     1     0     1     0     0     0     0     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>       2     1     1     1     0     0     1     0     1     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>       3     1     1     1     1     1     0     1     1     0     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>       4     1     0     1     0     0     1     0     1     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>       5     1     1     0     0     0     0     0     1     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>       6     1     1     1     0     1     0     0     1     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>       7     1     0     1     0     0     1     0     1     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>       8     0     1     1     0     0     1     0     1     1     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>       9     1     1     1     0     0     1     1     1     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      10     1     1     1     0     1     1     0     1     1     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,990 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 9 more variables: A12 &lt;int&gt;, A13 &lt;int&gt;, A14 &lt;int&gt;, A15 &lt;int&gt;, A16 &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   A17 &lt;int&gt;, A18 &lt;int&gt;, A19 &lt;int&gt;, A20 &lt;int&gt;</span></span></span>
<span></span>
<span><span class="va">sim_data</span><span class="op">$</span><span class="va">q_matrix</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 5</span></span></span>
<span><span class="co">#&gt;    item_id  att1  att2  att3  att4</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> A1          0     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> A2          0     0     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> A3          1     1     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> A4          1     0     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> A5          1     0     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> A6          0     1     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> A7          1     0     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> A8          0     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> A9          0     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> A10         1     0     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> A11         1     0     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> A12         0     0     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> A13         0     0     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> A14         0     0     1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> A15         0     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> A16         0     1     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> A17         0     0     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> A18         1     0     1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> A19         0     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> A20         0     0     0     1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="specifying-a-dcm-for-estimation">Specifying a DCM for Estimation<a class="anchor" aria-label="anchor" href="#specifying-a-dcm-for-estimation"></a>
</h2>
<p>In measr, DCMs are specified and estimated using the
<code><a href="../reference/measr_dcm.html">measr_dcm()</a></code> function. We’ll start by estimating a loglinear
cognitive diagnostic model (LCDM). The LCDM is a general DCM that
subsumes many other DCM subtypes <span class="citation">(<a href="#ref-lcdm" role="doc-biblioref">Henson et al.,
2009</a>)</span>.</p>
<p>First, we specify the data (<code>data</code>) and the Q-matrix
(<code>qmatrix</code>) that should be used to estimate the model. Note
that these are the only required arguments to the
<code><a href="../reference/measr_dcm.html">measr_dcm()</a></code> function. If no other arguments are provided,
sensible defaults (described below) will take care of the rest of the
specification and estimation. Next, we can specify which columns, if
any, in our <code>data</code> and <code>qmatrix</code> contain
respondent identifiers and item identifiers in, respectively. If one or
more of these variables are not present in the data, these arguments can
be omitted, and measr will assign identifiers based on the row number
(i.e., row 1 in <code>qmatrix</code> becomes item 1). We can then
specify the type of DCM we want to estimate. The current options are
<code>"lcdm"</code> (the default) <code>"dina"</code>, and
<code>"dino"</code> (see <a href="#subtype">Estimating Other DCM
Sub-Types</a> below).</p>
<p>You also have the option to choose which estimation engine to use,
via the <code>"backend"</code> argument. The default backend is
<code>backend = "rstan"</code>, which will use the <a href="https://mc-stan.org/rstan/" class="external-link">rstan</a> package to estimate the
model. Alternatively, you can use the <a href="https://mc-stan.org/cmdstanr/" class="external-link">cmdstanr</a> package to estimate
the model by specifying <code>backend = "cmdstanr"</code>. The cmdstanr
package works by using a local installation of Stan to estimate the
models, rather than the version that is pre-compiled in rstan. Once a
backend has been chosen, we can supply additional arguments to those
specific estimating functions. In the example below, I specify 500
warm-up iterations per chain, 500 post-warm-up iterations per chain, and
4 cores to run the chains in parallel. The full set up options available
for rstan and cmdstanr can be found by looking at the help pages for
<code><a href="https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html" class="external-link">rstan::sampling()</a></code> and
<code><a href="https://mc-stan.org/cmdstanr/reference/model-method-sample.html" class="external-link">cmdstanr::`model-method-sample`</a></code>, respectively.</p>
<p>Finally, because estimating these models can be time intensive, you
can specify a <code>file</code>. If a file is specified, an R object of
the fitted model will be automatically saved to the specified file. If
the specified <code>file</code> already exists, then the fitted model
will be read back into R, eliminating the need to re-estimate the
model.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lcdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/measr_dcm.html">measr_dcm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">data</span>, qmatrix <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">q_matrix</span>,</span>
<span>                  resp_id <span class="op">=</span> <span class="st">"resp_id"</span>, item_id <span class="op">=</span> <span class="st">"item_id"</span>,</span>
<span>                  type <span class="op">=</span> <span class="st">"lcdm"</span>, method <span class="op">=</span> <span class="st">"mcmc"</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>,</span>
<span>                  iter_warmup <span class="op">=</span> <span class="fl">1000</span>, iter_sampling <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                  chains <span class="op">=</span> <span class="fl">4</span>, parallel_chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                  file <span class="op">=</span> <span class="st">"fits/sim-lcdm"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="examining-parameter-estimates">Examining Parameter Estimates<a class="anchor" aria-label="anchor" href="#examining-parameter-estimates"></a>
</h3>
<p>Now that we’ve estimated a model, let’s compare our parameter
estimates to the true values used to generate the data. We can start be
looking at our estimates using <code><a href="../reference/measr_extract.html">measr_extract()</a></code>. This
function extracts different aspects of a model estimated with measr.
Here, the <code>estimate</code> column reports estimated value for each
parameter and a measure of the associated error (i.e., the standard
deviation of the posterior distribution). For example, item A1 measures
two attributes and therefore has four parameters:</p>
<ol style="list-style-type: decimal">
<li>An intercept, which represents the log-odds of providing a correct
response for a respondent who is proficient in neither of the attributes
this item measures (i.e., <code>att2</code> and <code>att4</code>).</li>
<li>A main effect for the second attribute, which represents the
increase in the log-odds of providing a correct response for a
respondent who is proficient in that attribute.</li>
<li>A main effect for the fourth attribute, which represents the
increase in the log-odds of providing a correct response for a
respondent who is proficient in that attribute.</li>
<li>An interaction between the second and fourth attributes, which is
the change in the log-odds for a respondent who is proficient in both
attributes.</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">item_parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/measr_extract.html">measr_extract</a></span><span class="op">(</span><span class="va">lcdm</span>, what <span class="op">=</span> <span class="st">"item_param"</span><span class="op">)</span></span>
<span><span class="va">item_parameters</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 66 × 5</span></span></span>
<span><span class="co">#&gt;    item_id class       attributes coef         estimate</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;glue&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;rvar[1d]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> A1      intercept   <span style="color: #BB0000;">NA</span>         l1_0    -0.98 <span style="color: #949494;">± 0.098</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> A1      maineffect  att2       l1_12    2.46 <span style="color: #949494;">± 0.158</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> A1      maineffect  att4       l1_14    4.46 <span style="color: #949494;">± 0.314</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> A1      interaction att2__att4 l1_224   0.15 <span style="color: #949494;">± 1.331</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> A2      intercept   <span style="color: #BB0000;">NA</span>         l2_0    -2.40 <span style="color: #949494;">± 0.301</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> A2      maineffect  att3       l2_13    3.99 <span style="color: #949494;">± 0.323</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> A2      maineffect  att4       l2_14    3.81 <span style="color: #949494;">± 0.339</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> A2      interaction att3__att4 l2_234  -3.58 <span style="color: #949494;">± 0.381</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> A3      intercept   <span style="color: #BB0000;">NA</span>         l3_0    -2.01 <span style="color: #949494;">± 0.160</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> A3      maineffect  att1       l3_11    2.22 <span style="color: #949494;">± 0.195</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 56 more rows</span></span></span></code></pre></div>
<p>We can compare these estimates to those that were used to generate
the data. In the figure below, most parameters fall on or very close to
the dashed line, which represents perfect agreement, indicating that the
estimated model is accurately estimating the parameter values.</p>
<p><img src="model-estimation_files/figure-html/lcdm-param-compare-1.png" alt="Figure shows a strong correlation between item parameters, with only a few discrepancies off of the line of perfect agreement." width="90%" style="display: block; margin: auto;"></p>
<p>We can also examine the structural parameters, which represent the
overall proportion of respondents in each class. Again, we see
relatively strong agreement between the estimates from our model and the
true generating values.</p>
<p><img src="model-estimation_files/figure-html/lcdm-strc-compare-1.png" alt="Figure shows a strong correlation between item parameters, with only a few discrepancies off of the line of perfect agreement." width="90%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="customizing-the-model-estimation-process">Customizing the Model Estimation Process<a class="anchor" aria-label="anchor" href="#customizing-the-model-estimation-process"></a>
</h2>
<div class="section level3">
<h3 id="prior-distributions">Prior Distributions<a class="anchor" aria-label="anchor" href="#prior-distributions"></a>
</h3>
<p>In the code to estimate the LCDM above, we did not specify any prior
distributions in the call to <code><a href="../reference/measr_dcm.html">measr_dcm()</a></code>. By default, measr
uses the following prior distributions for the LCDM:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/default_dcm_priors.html">default_dcm_priors</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"lcdm"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 3</span></span></span>
<span><span class="co">#&gt;   class       coef  prior_def                  </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> intercept   <span style="color: #BB0000;">NA</span>    normal(0, 2)               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> maineffect  <span style="color: #BB0000;">NA</span>    lognormal(0, 1)            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> interaction <span style="color: #BB0000;">NA</span>    normal(0, 2)               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> structural  Vc    dirichlet(rep_vector(1, C))</span></span></code></pre></div>
<p>As you can see, main effect parameters get a
<code>lognormal(0, 1)</code> prior by default. Different prior
distributions can be specified with the <code><a href="../reference/measrprior.html">prior()</a></code> function.
For example, we can specify a <code>normal(0, 10)</code> prior for the
main effects with:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/measrprior.html">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"maineffect"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;   class      coef  prior_def    </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> maineffect <span style="color: #BB0000;">NA</span>    normal(0, 10)</span></span></code></pre></div>
<p>By default, the prior is applied to all parameters in the class
(i.e., all main effects). However, we can also apply a prior to a
specific parameter. For example, here we specify a <span class="math inline">\(\chi^2\)</span> distribution with 2 degrees of
freedom as the default prior for main effects, and an exponential
distribution with a rate of 2 for the main effect of attribute 1 on just
item 7. To see all parameters (including <code>class</code> and
<code>coef</code>) that can be specified, we can use
<code><a href="../reference/get_parameters.html">get_parameters()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/measrprior.html">prior</a></span><span class="op">(</span><span class="fu">chi_square</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"maineffect"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/measrprior.html">prior</a></span><span class="op">(</span><span class="fu">exponential</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"maineffect"</span>, coef <span class="op">=</span> <span class="st">"l7_11"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   class      coef  prior_def     </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> maineffect <span style="color: #BB0000;">NA</span>    chi_square(2) </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> maineffect l7_11 exponential(2)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/get_parameters.html">get_parameters</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">q_matrix</span>, item_id <span class="op">=</span> <span class="st">"item_id"</span>, type <span class="op">=</span> <span class="st">"lcdm"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 67 × 4</span></span></span>
<span><span class="co">#&gt;    item_id class       attributes coef  </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;glue&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> A1      intercept   <span style="color: #BB0000;">NA</span>         l1_0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> A1      maineffect  att2       l1_12 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> A1      maineffect  att4       l1_14 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> A1      interaction att2__att4 l1_224</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> A2      intercept   <span style="color: #BB0000;">NA</span>         l2_0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> A2      maineffect  att3       l2_13 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> A2      maineffect  att4       l2_14 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> A2      interaction att3__att4 l2_234</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> A3      intercept   <span style="color: #BB0000;">NA</span>         l3_0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> A3      maineffect  att1       l3_11 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 57 more rows</span></span></span></code></pre></div>
<p>Any distribution that is supported by the <em>Stan</em> language can
be used as a prior. A list of all distributions is available in the
<em>Stan</em> documentation, and are linked to from the
<code>?prior()</code> help page.</p>
<p>Priors can be defined before estimating the function, or created at
the same time the model is estimated. For example, both of the following
are equivalent. Here we set the prior for main effects to be a truncated
normal distribution with a lower bound of 0. This is done because the
main effects in the LCDM are constrained to be positive to ensure
monotonicity in the model. Additionally note that I’ve set
<code>method = "optim"</code>. This means that we will estimate the
model using <em>Stan’s</em> optimizer, rather than using full Markov
Chain Monte Carlo. Note that the prior still influences the model when
using <code>method = "optim"</code>, just as they do when using
<code>method = "mcmc"</code> (the default).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/measrprior.html">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"maineffect"</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">new_lcdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/measr_dcm.html">measr_dcm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">data</span>, qmatrix <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">q_matrix</span>,</span>
<span>                      resp_id <span class="op">=</span> <span class="st">"resp_id"</span>, item_id <span class="op">=</span> <span class="st">"item_id"</span>,</span>
<span>                      type <span class="op">=</span> <span class="st">"lcdm"</span>, method <span class="op">=</span> <span class="st">"optim"</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>,</span>
<span>                      prior <span class="op">=</span> <span class="va">new_prior</span>,</span>
<span>                      file <span class="op">=</span> <span class="st">"fits/sim-lcdm-optim"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">new_lcdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/measr_dcm.html">measr_dcm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">data</span>, qmatrix <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">q_matrix</span>,</span>
<span>                      resp_id <span class="op">=</span> <span class="st">"resp_id"</span>, item_id <span class="op">=</span> <span class="st">"item_id"</span>,</span>
<span>                      type <span class="op">=</span> <span class="st">"lcdm"</span>, method <span class="op">=</span> <span class="st">"optim"</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>,</span>
<span>                      prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/measrprior.html">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"maineffect"</span>,</span>
<span>                                      lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      file <span class="op">=</span> <span class="st">"fits/sim-lcdm-optim"</span><span class="op">)</span></span></code></pre></div>
<p>The priors used to estimate the model are saved in the returned model
object, so we can always go back and see which priors were used if we
are unsure. We can see that for the <code>new_lcdm</code> model, our
specified normal prior was used for the main effects, but the default
priors were still applied to the parameters for which we did not
explicitly state a prior distribution.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/measr_extract.html">measr_extract</a></span><span class="op">(</span><span class="va">new_lcdm</span>, <span class="st">"prior"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 3</span></span></span>
<span><span class="co">#&gt;   class       coef  prior_def                  </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> maineffect  <span style="color: #BB0000;">NA</span>    normal(0, 15)T[0,]         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> intercept   <span style="color: #BB0000;">NA</span>    normal(0, 2)               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> interaction <span style="color: #BB0000;">NA</span>    normal(0, 2)               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> structural  Vc    dirichlet(rep_vector(1, C))</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="subtype">Other DCM Sub-Types<a class="anchor" aria-label="anchor" href="#subtype"></a>
</h3>
<p>Although a primary motivation for measr is to provide researchers
with software that makes the LCDM readily accessible, a few other
popular DCM subtypes are also supported. For example, we can estimate
the deterministic inputs, noisy “and” gate <span class="citation">(DINA,
<a href="#ref-junker2001" role="doc-biblioref">Junker &amp; Sijtsma,
2001</a>)</span> or the deterministic inputs, noisy “or” gate <span class="citation">(DINO, <a href="#ref-templin2006" role="doc-biblioref">Templin &amp; Henson, 2006</a>)</span> models by
specifying a different <code>type</code> in the <code><a href="../reference/measr_dcm.html">measr_dcm()</a></code>
function.</p>
<p>Future development work will continue to add functionality for more
DCM subtypes. If there is a specific subtype you are interested in, or
would like to see supported, please open an issue on the <a href="https://github.com/wjakethompson/measr/issues" class="external-link">GitHub
repository</a>.</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-lcdm" class="csl-entry">
Henson, R., Templin, J. L., &amp; Willse, J. T. (2009). Defining a
family of cognitive diagnosis models using log-linear models with latent
variables. <em>Psychometrika</em>, <em>74</em>(2), 191–210. <a href="https://doi.org/10.1007/s11336-008-9089-5" class="external-link">https://doi.org/10.1007/s11336-008-9089-5</a>
</div>
<div id="ref-junker2001" class="csl-entry">
Junker, B. W., &amp; Sijtsma, K. (2001). Cognitive assessment models
with few assumptions, and connections with nonparametric item response
theory. <em>Applied Psychological Measurement</em>, <em>25</em>(3),
258–272. <a href="https://doi.org/10.1177/01466210122032064" class="external-link">https://doi.org/10.1177/01466210122032064</a>
</div>
<div id="ref-templin2006" class="csl-entry">
Templin, J., &amp; Henson, R. A. (2006). Measurement of psychological
disorders using cognitive diagnosis models. <em>Psychological
Methods</em>, <em>11</em>(3), 287–305. <a href="https://doi.org/10.1037/1082-989X.11.3.287" class="external-link">https://doi.org/10.1037/1082-989X.11.3.287</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://wjakethompson.com" class="external-link">W. Jake Thompson</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>The research reported here was supported by the Institute of Education Sciences, U.S. Department of Education, through Grant <a href="https://ies.ed.gov/funding/grantsearch/details.asp?ID=4546" class="external-link">R305D210045</a> to the University of Kansas. The opinions expressed are those of the authors and do not represent the views of the Institute or the U.S. Department of Education.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
