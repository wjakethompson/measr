<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Posterior predictive model checks for assessing model fit — fit_ppmc • measr</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Open_Sans-0.4.10/font.css" rel="stylesheet"><link href="../deps/Fira_Code-0.4.10/font.css" rel="stylesheet"><link href="../deps/Playfair_Display-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Posterior predictive model checks for assessing model fit — fit_ppmc"><meta name="description" content='For models estimated with method = "mcmc", use the posterior distributions
to compute expected distributions for fit statistics and compare to values
in the observed data.'><meta property="og:description" content='For models estimated with method = "mcmc", use the posterior distributions
to compute expected distributions for fit statistics and compare to values
in the observed data.'><meta property="og:image" content="https://measr.info/reference/figures/card.png"><meta property="og:image:alt" content=""><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@wjakethompson"><meta name="twitter:site" content="@atlas4learning"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">measr</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.0.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/measr.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/paper.html">measr: Bayesian psychometric measurement using Stan</a></li>
    <li><a class="dropdown-item" href="../articles/model-estimation.html">Estimating diagnostic classification models</a></li>
    <li><a class="dropdown-item" href="../articles/model-evaluation.html">Evaluating diagnostic classification models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Case Studies</h6></li>
    <li><a class="dropdown-item" href="../articles/ecpe.html">Examination for the Certificate of Proficiency in English</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.wjakethompson.com/blog/measr/2024-02-measr-1.0.0/">Version 1.0.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.wjakethompson.com/blog/measr/2023-06-measr-0.3.1/">Version 0.3.1</a></li>
    <li><a class="external-link dropdown-item" href="https://www.wjakethompson.com/blog/measr/2023-04-measr-0.2.1/">Version 0.2.1</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/wjakethompson/measr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Posterior predictive model checks for assessing model fit</h1>
      <small class="dont-index">Source: <a href="https://github.com/wjakethompson/measr/blob/main/R/zzz-methods-ppmc.R" class="external-link"><code>R/zzz-methods-ppmc.R</code></a></small>
      <div class="d-none name"><code>fit_ppmc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>For models estimated with <code>method = "mcmc"</code>, use the posterior distributions
to compute expected distributions for fit statistics and compare to values
in the observed data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_ppmc</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  model_fit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  item_fit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ndraws <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>  return_draws <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  force <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An estimated model object (e.g., from <code><a href="dcm_estimate.html">dcm_estimate()</a></code>).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Unused. For future extensions.</p></dd>


<dt id="arg-model-fit">model_fit<a class="anchor" aria-label="anchor" href="#arg-model-fit"></a></dt>
<dd><p>The posterior predictive model checks to compute for an
evaluation of model-level fit. If <code>NULL</code>, no model-level checks are
computed. See details.</p></dd>


<dt id="arg-item-fit">item_fit<a class="anchor" aria-label="anchor" href="#arg-item-fit"></a></dt>
<dd><p>The posterior predictive model checks to compute for an
evaluation of item-level fit. If <code>NULL</code>, no item-level checks are computed.
See details.</p></dd>


<dt id="arg-ndraws">ndraws<a class="anchor" aria-label="anchor" href="#arg-ndraws"></a></dt>
<dd><p>The number of posterior draws to base the checks on. Must be
less than or equal to the total number of posterior draws retained in the
estimated model. If <code>NULL</code> (the default) the total number from the
estimated model is used.</p></dd>


<dt id="arg-probs">probs<a class="anchor" aria-label="anchor" href="#arg-probs"></a></dt>
<dd><p>The percentiles to be computed by the <code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">stats::quantile()</a></code>
function for summarizing the posterior distribution for each fit statistic.</p></dd>


<dt id="arg-return-draws">return_draws<a class="anchor" aria-label="anchor" href="#arg-return-draws"></a></dt>
<dd><p>Number of posterior draws for each specified fit
statistic to be returned. This does not affect the calculation of the
posterior predictive checks, but can be useful for visualizing the fit
statistics. Must be less than <code>ndraws</code> (or the total number of draws if
<code>ndraws = NULL</code>). If <code>0</code> (the default), only summaries of the posterior are
returned (no individual samples).</p></dd>


<dt id="arg-force">force<a class="anchor" aria-label="anchor" href="#arg-force"></a></dt>
<dd><p>If all requested <acronym>PPMC</acronym>s have already been added to the
model object using <code><a href="model_evaluation.html">add_fit()</a></code>, should they be recalculated. Default is
<code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with two elements, "model_fit" and "item_fit". If either
<code>model_fit = NULL</code> or <code>item_fit = NULL</code> in the function call, this will be
a one-element list, with the null criteria excluded. Each list element, is
itself a list with one element for each specified <acronym>PPMC</acronym> containing
a <a href="https://tibble.tidyverse.org/reference/tibble-package.html" class="external-link">tibble</a>. For example if
<code>item_fit = c("conditional_prob", "odds_ratio")</code>, the "item_fit" element
will be a list of length two, where each element is a tibble containing the
results of the <acronym>PPMC</acronym>. All tibbles follow the same general
structure:</p>
<ul><li><p><code>obs_{ppmc}</code>: The value of the relevant statistic in the observed
data.</p></li>
<li><p><code>ppmc_mean</code>: The mean of the <code>ndraws</code> posterior samples calculated
for the given statistic.</p></li>
<li><p>Quantile columns: 1 column for each value of <code>probs</code>, providing the
corresponding quantiles of the <code>ndraws</code> posterior samples calculated for
the given statistic.</p></li>
<li><p><code>samples</code>: A list column, where each element contains a vector of
length <code>return_draws</code>, representing samples from the posterior
distribution of the calculated statistic. This column is excluded if
<code>return_draws = 0</code>.</p></li>
<li><p><code>ppp</code>: The posterior predictive p-value. This is the proportion of
posterior samples for calculated statistic that are greater than the
observed value. Values very close to 0 or 1 indicate incompatibility
between the fitted model and the observed data.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Posterior predictive model checks (PPMCs) use the posterior distribution of
an estimated model to compute different statistics. This creates an expected
distribution of the given statistic, <em>if our estimated parameters are
correct</em>. We then compute the statistic in our observed data and compare the
observed value to the expected distribution. Observed values that fall
outside of the expected distributions indicate incompatibility between the
estimated model and the observed data.</p>
<p>For DCMs, we currently support PPMCs at the model and item level. At the
model level, we calculate the expected raw score distribution
(<code>model_fit = "raw_score"</code>) as described by Thompson (2019) and Park et al.
(2015). At the item level, we can calculate the conditional probability that
a respondent in each class provides a correct response (<code>item_fit = "conditional_prob"</code>) as described by Thompson (2019) and Sinharay &amp; Almond
(2007) or the overall proportion correct for an item (<code>item_fit = "pvalue"</code>),
as described by Thompson (2019). We can also calculate the odds ratio for
each pair of items (<code>item_fit = "odds_ratio"</code>) as described by Park et al.
(2015) and Sinharay et al. (2006).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Park, J. Y., Johnson, M. S., Lee, Y-S. (2015). Posterior
predictive model checks for cognitive diagnostic models. <em>International
Journal of Quantitative Research in Education, 2</em>(3-4), 244-264.
<a href="https://doi.org/10.1504/IJQRE.2015.071738" class="external-link">doi:10.1504/IJQRE.2015.071738</a></p>
<p>Sinharay, S., &amp; Almond, R. G. (2007). Assessing fit of cognitive
diagnostic models. <em>Educational and Psychological Measurement, 67</em>(2),
239-257. <a href="https://doi.org/10.1177/0013164406292025" class="external-link">doi:10.1177/0013164406292025</a></p>
<p>Sinharay, S., Johnson, M. S., &amp; Stern, H. S. (2006). Posterior
predictive assessment of item response theory models. <em>Applied
Psychological Measurement, 30</em>(4), 298-321.
<a href="https://doi.org/10.1177/0146621605285517" class="external-link">doi:10.1177/0146621605285517</a></p>
<p>Thompson, W. J. (2019). <em>Bayesian psychometrics for diagnostic
assessments: A proof of concept</em> (Research Report No. 19-01). University
of Kansas; Accessible Teaching, Learning, and Assessment Systems.
<a href="https://doi.org/10.35542/osf.io/jzqs8" class="external-link">doi:10.35542/osf.io/jzqs8</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">mdm_dina</span> <span class="op">&lt;-</span> <span class="fu"><a href="dcm_estimate.html">dcm_estimate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dcmstan.r-dcm.org/reference/dcm_specify.html" class="external-link">dcm_specify</a></span><span class="op">(</span><span class="fu">dcmdata</span><span class="fu">::</span><span class="va"><a href="https://dcmdata.r-dcm.org/reference/mdm.html" class="external-link">mdm_qmatrix</a></span>, identifier <span class="op">=</span> <span class="st">"item"</span>,</span></span>
<span class="r-in"><span>              measurement_model <span class="op">=</span> <span class="fu"><a href="https://dcmstan.r-dcm.org/reference/measurement-model.html" class="external-link">dina</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="fu">dcmdata</span><span class="fu">::</span><span class="va"><a href="https://dcmdata.r-dcm.org/reference/mdm.html" class="external-link">mdm_data</a></span>, missing <span class="op">=</span> <span class="cn">NA</span>, identifier <span class="op">=</span> <span class="st">"respondent"</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"mcmc"</span>, seed <span class="op">=</span> <span class="fl">63277</span>, backend <span class="op">=</span> <span class="st">"rstan"</span>,</span></span>
<span class="r-in"><span>  iter <span class="op">=</span> <span class="fl">700</span>, warmup <span class="op">=</span> <span class="fl">500</span>, chains <span class="op">=</span> <span class="fl">2</span>, refresh <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#bulk-ess</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#tail-ess</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">fit_ppmc</span><span class="op">(</span><span class="va">mdm_dina</span>, model_fit <span class="op">=</span> <span class="st">"raw_score"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ppmc_raw_score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   obs_chisq ppmc_mean `2.5%` `97.5%`   ppp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>      5.45      6.32  0.656    19.3 0.465</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://wjakethompson.com" class="external-link">W. Jake Thompson</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

